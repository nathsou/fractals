import{a as e}from"./vendor.080e648e.js";var r,t={};r=e.exports,function(){var e=r.getCore(),t=e.PARSER,i=e.groups.N,n=e.groups.P,a=e.groups.S,s=e.groups.EX,o=e.groups.FN,l=e.groups.PL,u=e.groups.CP,p=e.groups.CB,f=e.Utils.keys,c=e.Utils.even,m=e.Utils.variables,g=e.Utils.format,h=e.Utils.round,v=e.Frac,d=e.Utils.isInt,w=e.Symbol,y=e.Settings.CONST_HASH,b=e.Utils.importFunctions();function S(r,i,n){if(e.Utils.isSymbol(r))this.parse(r),this.variable=this.variable||i;else if(isNaN(r))"string"==typeof r&&this.parse(t.parse(r));else{if(n=n||0,void 0===i)throw new e.exceptions.InvalidVariableNameError("Polynomial expects a variable name when creating using order");this.coeffs=[],this.coeffs[n]=r,this.fill(r)}}function q(){this.factors={},this.length=0}function U(r,t,i){this.terms=t||[],this.coeff=r,this.map=i,this.sum=new e.Frac(0),this.image=void 0}e.Utils.evaluate,S.fromArray=function(r,t){if(void 0===t)throw new e.exceptions.InvalidVariableNameError("A variable name must be specified when creating polynomial from array");var i=new S;return i.coeffs=r,i.variable=t,i},S.fit=function(e,r,t,i,n,a){var s=new Array(n+1),o=t-r;s[0]=r,s[n]=e,o-=e*Math.pow(i,n);for(var l=n-1;l>0;l--){var u=Math.pow(i,l),p=o/u,f=Math.sign(p)*Math.floor(Math.abs(p));o-=f*u,s[l]=f}if(0!==o)return null;for(l=0;l<s.length;l++)s[l]=new v(s[l]);return S.fromArray(s,a)},S.prototype={parse:function(r,n){if(this.variable=m(r)[0],!r.isPoly())throw e.exceptions.NerdamerTypeError("Polynomial Expected! Received "+e.Utils.text(r));if(n=n||[],r.power.absEquals(1)||(r=t.expand(r)),r.group===e.groups.N)n[0]=r.multiplier;else if(r.group===e.groups.S)n[r.power.toDecimal()]=r.multiplier;else for(var a in r.symbols){var s=r.symbols[a],o=s.power;if(e.Utils.isSymbol(o))throw new e.exceptions.NerdamerTypeError("power cannot be a Symbol");o=s.group===i?0:o.toDecimal(),s.symbols?this.parse(s,n):n[o]=s.multiplier}this.coeffs=n,this.fill()},fill:function(e){e=Number(e)||0;for(var r=this.coeffs.length,t=0;t<r;t++)void 0===this.coeffs[t]&&(this.coeffs[t]=new v(e));return this},trim:function(){for(var e=this.coeffs.length;e--;){var r=this.coeffs[e],t=r.equals(0);if(!r||!t)break;if(0===e)break;this.coeffs.pop()}return this},modP:function(e){for(var r=this.coeffs.length,t=0;t<r;t++){var i=this.coeffs[t];if(i<0){for(var n,a=t;a<r;a++)if(this.coeffs[a]>0){n=this.coeffs[a];break}if(n){for(;a>t;a--)this.coeffs[a]=this.coeffs[a].subtract(new v(1)),this.coeffs[a-1]=this.coeffs[a-1].add(new v(e));i=this.coeffs[t]}}var s=i.mod(e),o=i.subtract(s).divide(e);if(!o.equals(0)){var l=t+1,u=this.coeffs[l]||new v(0);u=u.add(o),this.coeffs[l]=new v(u),this.coeffs[t]=new v(s)}}return this},add:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.add(n)}return this},subtract:function(e){for(var r=Math.max(this.coeffs.length,e.coeffs.length),t=0;t<r;t++){var i=this.coeffs[t]||new v(0),n=e.coeffs[t]||new v(0);this.coeffs[t]=i.subtract(n)}return this},divide:function(r){for(var t=this.variable,i=e.Utils.arrayClone(this.coeffs),n=e.Utils.arrayClone(r.coeffs),a=i.length,s=n.length-1,o=[],l=0;l<a;l++){var u=a-(l+1),p=u-s,f=i[u].divide(n[s]);if(p<0)break;o[p]=f;for(var c=0;c<=s;c++)i[c+p]=i[c+p].subtract(n[c].multiply(f))}var m=S.fromArray(i,t||"x").trim();return[S.fromArray(o,t||"x"),m]},multiply:function(e){for(var r=this.coeffs.length,t=e.coeffs.length,i=[],n=0;n<r;n++)for(var a=this.coeffs[n],s=0;s<t;s++){var o=n+s,l=e.coeffs[s],u=i[o]||new v(0);i[o]=u.add(a.multiply(l))}return this.coeffs=i,this},isZero:function(){for(var e=this.coeffs.length,r=0;r<e;r++)if(!this.coeffs[r].equals(0))return!1;return!0},sub:function(e){for(var r=new v(0),t=this.coeffs.length,i=0;i<t;i++){var n=this.coeffs[i];n.equals(0)||(r=r.add(n.multiply(new v(Math.pow(e,i)))))}return r},clone:function(){var e=new S;return e.coeffs=this.coeffs,e.variable=this.variable,e},deg:function(){return this.trim(),this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var e=this.lc(),r=this.coeffs.length,t=0;t<r;t++)this.coeffs[t]=this.coeffs[t].divide(e);return this},gcd:function(r){if(this.coeffs.length-1<r.coeffs.length-1)return r.gcd(this);for(var t=this;!r.isZero();){var i=r.clone();r=(t=t.clone()).divide(i)[1],t=i}var n=e.Math2.QGCD.apply(null,t.coeffs);if(!n.equals(1))for(var a=t.coeffs.length,s=0;s<a;s++)t.coeffs[s]=t.coeffs[s].divide(n);return t},diff:function(){for(var e=[],r=this.coeffs.length,t=1;t<r;t++)e.push(this.coeffs[t].multiply(new v(t)));return this.coeffs=e,this},integrate:function(){for(var e=[0],r=this.coeffs.length,t=0;t<r;t++){var i=new v(t+1);e[i]=this.coeffs[t].divide(i)}return this.coeffs=e,this},gcf:function(r){for(var t=[],i=0;i<this.coeffs.length;i++){var n=this.coeffs[i];n.equals(0)||-1!==t.indexOf(n)||t.push(n)}var a=[e.Math2.QGCD.apply(void 0,t),function(e){for(var r=0;r<e.length;r++)if(!e[r].equals(0))return r}(this.coeffs)].toDecimal();if(r){var s=[];s[a[1]-1]=a[0],a=S.fromArray(s,this.variable).fill()}return a},quad:function(e){var r=[];if(this.coeffs.length>3)throw new Error("Cannot calculate quadratic order of "+(this.coeffs.length-1));if(0===this.coeffs.length)throw new Error("Polynomial array has no terms");var t=this.coeffs[2]||0,i=this.coeffs[1]||0,n=i*i-4*t*this.coeffs[0];return n<0&&!e||(r[0]=(-i+Math.sqrt(n))/(2*t),r[1]=(-i-Math.sqrt(n))/(2*t)),r},squareFree:function(){for(var e=this.clone(),r=1,t=e.clone().diff(),i=e.clone().gcd(t),n=e.divide(i)[0],a=S.fromArray([new v(1)],e.variable);!i.equalsNumber(1);){var s=n.gcd(i),o=n.divide(s)[0];if(!o.equalsNumber(1)&&r>1){for(var l=o.clone(),u=1;u<r;u++)l.multiply(o.clone());o=l}a=a.multiply(o),r++,n=s,i=i.divide(s)[0]}return[a,n,r]},toSymbol:function(){var r=this.coeffs.length,i=this.variable;if(0===r)return new e.Symbol(0);for(var n=r-1,a="",s=0;s<r;s++){var o=s===n?"":"+",l=this.coeffs[s];l.equals(0)||(a+=l+"*"+i+"^"+s+o)}return t.parse(a)},equalsNumber:function(e){return this.trim(),1===this.coeffs.length&&this.coeffs[0].toDecimal()===String(e)},toString:function(){return this.toSymbol().toString()}},w.prototype.coeffs=function(e,r){r&&!this.isPoly(!0)&&t.error("Polynomial expected when requesting coefficients with order"),e=e||[];var i=this.clone().distributeMultiplier();if(i.isComposite())for(var n in i.symbols){var a=i.symbols[n];a.isComposite()?a.clone().distributeMultiplier().coeffs(e,r):r?e[a.isConstant()?0:a.power.toDecimal()]=a.multiplier:e.push(a.multiplier)}else if(r)e[i.isConstant(!0)?0:i.power.toDecimal()]=i.multiplier;else if(i.group===p&&i.isImaginary()){var s=new w(i.multiplier);i.each((function(e){(e.isConstant(!0)||e.imaginary)&&(s=t.multiply(s,e))})),e.push(s)}else e.push(i.multiplier);if(r)for(var o=0;o<e.length;o++)void 0===e[o]&&(e[o]=new w(0));return e},w.prototype.tBase=function(e){if(void 0===e)throw new Error("Symbol.tBase requires a map object!");for(var r=[],t=this.collectSymbols(null,null,null,!0),i=t.length,n=0;n<i;n++){var a=t[n],s=a.group,o=new U(a.multiplier,[],e);if(s===p)for(var l in a.symbols){var u=a.symbols[l];o.terms[e[l]]=u.power}else o.terms[e[a.value]]=a.power;r.push(o.fill()),o.updateCount()}return r},w.prototype.altVar=function(e){var r=this.multiplier.toString(),t=this.power.toString();return("1"===r?"":r+"*")+e+("1"===t?"":"^"+t)},w.prototype.sameVars=function(e){if(!this.symbols&&this.group!==e.group)return!1;for(var r in this.symbols){var t=this.symbols[r],i=e.symbols[r];if(!i)return!1;if(t.value!==i.value)return!1}return!0},w.prototype.groupTerms=function(r){var i,n,a;r=String(r);var s=[];return this.each((function(o){if(o.group===l){a=o.groupTerms(r);for(var u=0;u<a.length;u++){var p=a[u];p&&(s[u]=p)}}else i=e.Utils.decompose_fn(o,r,!0),n=i.x.value===r?Number(i.x.power):0,s[n]=t.add(s[n]||new w(0),i.a)})),s},w.prototype.collectFactors=function(){var e=[];return this.group===p?this.each((function(r){e.push(r.clone())})):e.push(this.clone()),e},q.prototype.getNumberSymbolics=function(){var e=0;return this.each((function(r){r.isConstant(!0)||e++})),e},q.prototype.add=function(r){if(r.equals(0))return this;if(r.equals(-1)&&this.length>0){var i=e.Utils.firstObject(this.factors,null,!0);return this.add(t.symfunction(e.Settings.PARENTHESIS,[i.obj]).negate()),delete this.factors[i.key],this.length--,this}if(r.group===p){var n=this;r.multiplier.equals(1)||n.add(new w(r.multiplier)),r.each((function(e){n.add(e)}))}else{this.preAdd&&(r=this.preAdd(r)),this.pFactor&&(r=t.pow(r,new w(this.pFactor)));var a=r.isConstant();if(a&&r.equals(1))return this;var s=a?r.value:r.text();s in this.factors?(this.factors[s]=t.multiply(this.factors[s],r),this.factors[s].equals(1)&&(delete this.factors[s],this.length--)):(this.factors[s]=r,this.length++)}return this},q.prototype.toSymbol=function(){for(var r=new w(1),i=Object.values(this.factors).sort((function(e,r){return e.group>r.group})),n=0,a=i.length;n<a;n++){var s=i[n],o=s.power.equals(1)&&""!==s.fname?t.symfunction(e.PARENTHESIS,[s]):s;r=t.multiply(r,o)}return""===r.fname&&(r=w.unwrapPARENS(r)),r},q.prototype.merge=function(e){for(var r in e)r in this.factors?this.factors[r]=t.multiply(this.factors[r],e[r]):this.factors[r]=e[r];return this},q.prototype.each=function(r){for(var t in this.factors){var i=this.factors[t];i.fname===e.PARENTHESIS&&i.isLinear()&&(i=i.args[0]),r.call(this,i,t)}return this},q.prototype.count=function(){return f(this.factors).length},q.prototype.clean=function(){try{var r=e.Settings.CONST_HASH;this.factors[r].lessThan(0)&&(this.factors[r].equals(-1)?delete this.factors[r]:this.factors[r].negate(),this.each((function(e){e.negate()})))}catch(t){}},q.prototype.toString=function(){return this.toSymbol().toString()},U.prototype.updateCount=function(){this.count=this.count||0;for(var e=0;e<this.terms.length;e++)this.terms[e].equals(0)||this.count++;return this},U.prototype.getVars=function(){for(var e=[],r=0;r<this.terms.length;r++){var t=this.terms[r];this.getRevMap(),t.equals(0)||e.push(this.rev_map[r])}return e.join(" ")},U.prototype.len=function(){return void 0===this.count&&this.updateCount(),this.count},U.prototype.toSymbol=function(e){e=e||this.getRevMap();for(var r=new w(this.coeff),i=0;i<this.terms.length;i++){var n=e[i],a=this.terms[i];if(!a.equals(0)&&n!==y){var s=new w(n);s.power=a,r=t.multiply(r,s)}}return r},U.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var e={};for(var r in this.map)e[this.map[r]]=r;return this.rev_map=e,e},U.prototype.generateImage=function(){return this.image=this.terms.join(" "),this},U.prototype.getImg=function(){return this.image||this.generateImage(),this.image},U.prototype.fill=function(){for(var r=this.map.length,t=0;t<r;t++)void 0===this.terms[t]?this.terms[t]=new e.Frac(0):this.sum=this.sum.add(this.terms[t]);return this},U.prototype.divide=function(e){for(var r=this.coeff.divide(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].subtract(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.multiply=function(e){for(var r=this.coeff.multiply(e.coeff),t=this.terms.length,i=new U(r,[],this.map),n=0;n<t;n++)i.terms[n]=this.terms[n].add(e.terms[n]),i.sum=i.sum.add(i.terms[n]);return i},U.prototype.isZero=function(){return this.coeff.equals(0)},U.prototype.toString=function(){return"{ coeff: "+this.coeff.toString()+", terms: ["+this.terms.join(",")+"]: sum: "+this.sum.toString()+", count: "+this.count+"}"},e.Utils.toMapObj=function(e){for(var r=0,t={},i=0;i<e.length;i++){var n=e[i];void 0===t[n]&&(t[n]=r,r++)}return t.length=r,t},e.Utils.filledArray=function(e,r,t){for(var i=[];r--;)i[r]=t?new t(e):e;return i},e.Utils.arrSum=function(e){for(var r=0,t=e.length,i=0;i<t;i++)r+=e[i];return r},e.Utils.haveIntersection=function(e,r){var t;return r.length>e.length&&(t=r,r=e,e=t),e.some((function(e){return r.indexOf(e)>-1}))},e.Utils.subFunctions=function(r,t){t=t||{};var i=[];return r.each((function(r){if(r.group===o||r.previousGroup===o){var n=e.Utils.text(r,"hash"),a=t[n];if(a)i.push(r.altVar(a));else{var s=r.fname+f(t).length;t[n]=s,i.push(r.altVar(s))}}else r.group===p||r.group===l||r.group===u?i.push(e.Utils.subFunctions(r,t)):i.push(r.text())})),r.group===u||r.group===l?r.altVar(e.Utils.inBrackets(i.join("+"))):r.group===p?r.altVar(e.Utils.inBrackets(i.join("*"))):r.text()},e.Utils.getFunctionsSubs=function(e){var r={};for(var i in e)r[e[i]]=t.parse(i);return r};var M=e.Algebra={version:"1.4.6",proots:function(r,i){i=i||7;var n=[],s=function(r,t,a){for(var s=function(r,t,n){var a=100,s=r.slice(0);if(r.unshift(n),n>a)throw new e.exceptions.ValueLimitExceededError("This utility accepts polynomials of degree up to "+a+". ");var o=[],l={};for(l.Degree=n,S=0;S<n;S++)o.push(0);var u=o.slice(0);function p(e,r,t,i,n,a){n[0]=a.b=i[0],n[1]=a.a=-r*a.b+i[1];for(var s=2;s<e;s++)n[s]=-(r*a.a+t*a.b)+i[s],a.b=a.a,a.a=n[s]}function f(e,r,t,i,n,a,s,o,l){var u=new Object,f=3;return u.b=u.a=0,p(r,s,o,a,l,u),n.c=u.a,n.d=u.b,Math.abs(n.c)<=100*e*Math.abs(a[r-1])&&Math.abs(n.d)<=100*e*Math.abs(a[r-2])||(n.h=o*i,Math.abs(n.d)>=Math.abs(n.c)?(f=2,n.e=t/n.d,n.f=n.c/n.d,n.g=s*i,n.a3=n.e*(n.g+t)+n.h*(i/n.d),n.a1=-t+n.f*i,n.a7=n.h+(n.f+s)*t):(f=1,n.e=t/n.c,n.f=n.d/n.c,n.g=n.e*s,n.a3=n.e*t+(n.g+n.h/n.c)*i,n.a1=-t*(n.d/n.c)+i,n.a7=n.g*n.d+n.h*n.f+t)),f}function c(e,r,t,i,n,a,s,o,l){var u;if(3!=t)if(u=1==t?n:i,Math.abs(a.a1)>10*e*Math.abs(u))for(a.a7/=a.a1,a.a3/=a.a1,s[0]=l[0],s[1]=-l[0]*a.a7+l[1],p=2;p<r;p++)s[p]=-l[p-1]*a.a7+o[p-2]*a.a3+l[p];else for(s[0]=0,s[1]=-l[0]*a.a7,p=2;p<r;p++)s[p]=-l[p-1]*a.a7+o[p-2]*a.a3;else{s[1]=s[0]=0;for(var p=2;p<r;p++)s[p]=o[p-2]}}function m(e,r,t,i,n,a,s,o,l,u,p,f,c,m,g,h,v){var d,w,y,b,S,q,U,M;r.b=r.a=0,3!=e&&(2!=e?(d=t+c*s+f*u,w=o+(c+m*u)*l):(d=(t+p)*u+f,w=(u+c)*o+m*l),0!=(M=-(U=-((S=(y=-g[h-1]/v[h])*a)+(q=y*y*n))+m*(b=-(g[h-2]+y*v[h-1])/v[h])*i)+w+y*d)&&(r.a=-(c*(q+S)+m*(y*i+b*a))/M+c,r.b=m*(1+U/M)))}function g(e,r,t,i){var n,a,s;i.sr=i.si=i.lr=i.li=0,0!=e?0!=t?(n=r/2,Math.abs(n)<Math.abs(t)?(s=-(s=t>=0?e:-e)+n*(n/Math.abs(t)),a=Math.sqrt(Math.abs(s))*Math.sqrt(Math.abs(t))):(s=-e/n*(t/n)+1,a=Math.sqrt(Math.abs(s))*Math.abs(n)),s>=0?(a=n>=0?-a:a,i.lr=(-n+a)/e,i.sr=0!=i.lr?t/i.lr/e:i.sr):(i.lr=i.sr=-n/e,i.si=Math.abs(a/e),i.li=-i.si)):i.lr=-r/e:i.sr=0!=r?-t/r:i.sr}function v(e,r,t,i,n,a,s,o,l,u,h,v){var d,w,y,b,S,q,U,M,x,L,N,C=new Object,k=0,_=0;t.NZ=0,q=i,M=n;do{if(C.li=C.lr=C.si=C.sr=0,g(1,q,M,C),t.szr=C.sr,t.szi=C.si,t.lzr=C.lr,t.lzi=C.li,Math.abs(Math.abs(t.szr)-Math.abs(t.lzr))>.01*Math.abs(t.lzr))break;for(p(s,q,M,l,a,o),w=Math.abs(-t.szr*o.b+o.a)+Math.abs(t.szi*o.b),L=Math.sqrt(Math.abs(M)),d=2*Math.abs(a[0]),S=-t.szr*o.b,N=1;N<r;N++)d=d*L+Math.abs(a[N]);if(w<=20*(d=(9*(d=d*L+Math.abs(S+o.a))+2*Math.abs(S)-7*(Math.abs(o.a+S)+L*Math.abs(o.b)))*e)){t.NZ=2;break}if(++k>20)break;if(k>=2&&b<=.01&&w>=y&&!_){for(p(s,q-=q*(b=b<e?Math.sqrt(e):Math.sqrt(b)),M+=M*b,l,a,o),N=0;N<5;N++)c(e,r,f(e,r,o.a,o.b,h,v,q,M,u),o.a,o.b,h,v,u,a);_=1,k=0}y=w,c(e,r,f(e,r,o.a,o.b,h,v,q,M,u),o.a,o.b,h,v,u,a),m(f(e,r,o.a,o.b,h,v,q,M,u),o,o.a,h.a1,h.a3,h.a7,o.b,h.c,h.d,h.f,h.g,h.h,q,M,v,r,l),U=o.a,0!=(x=o.b)&&(b=Math.abs((-M+x)/x),q=U,M=x)}while(0!=x)}function d(e,r,t,i,n,a,s,o,l){var u,p,f,c,m,g,h,v,d,w,y,b=i-1;for(r.NZ=y=d=0,h=t.a;;){for(g=n[0],s[0]=g,w=1;w<a;w++)s[w]=g=g*h+n[w];for(f=Math.abs(g),c=Math.abs(h),u=.5*Math.abs(s[0]),w=1;w<a;w++)u=u*c+Math.abs(s[w]);if(f<=20*e*(2*u-f)){r.NZ=1,r.szr=h,r.szi=0;break}if(++y>10)break;if(y>=2&&Math.abs(v)<=.001*Math.abs(-v+h)&&f>m){d=1,r.a=h;break}for(m=f,l[0]=p=o[0],w=1;w<i;w++)l[w]=p=p*h+o[w];if(Math.abs(p)>10*Math.abs(o[b])*e)for(v=-g/p,o[0]=s[0],w=1;w<i;w++)o[w]=v*l[w-1]+s[w];else for(o[0]=0,w=1;w<i;w++)o[w]=l[w-1];for(p=o[0],w=1;w<i;w++)p=p*h+o[w];h+=v=Math.abs(p)>10*Math.abs(o[b])*e?-g/p:0}return d}function w(e,r,t,i,n,a,s,o,l,u,g,h){var w,y,b,S,q,U,M,x,L,N,C,k,_,F,T,A,E,I,D,P,R,O,V,G,z,j=new Object,B=new Object,H=new Array(r),Q=new Array(r),Z=1;for(h.NZ=0,S=b=.25,q=i,x=n,j.b=j.a=0,p(l,g,n,o,u,j),w=j.a,y=j.b,B.h=B.g=B.f=B.e=B.d=B.c=B.a7=B.a3=B.a1=0,V=f(e,s,w,y,B,a,g,n,H),P=0;P<t;P++){if(I=1,c(e,s,V,w,y,B,a,H,u),m(V=f(e,s,w,y,B,a,g,n,H),j,w,B.a1,B.a3,B.a7,y,B.c,B.d,B.f,B.g,B.h,g,n,a,s,o),T=j.a,E=A=j.b,N=0!=a[s-1]?-o[s]/a[s-1]:0,C=_=1,0!=P&&3!=V&&(G=(F=(_=0!=E?Math.abs((E-x)/E):_)<M?_*M:1)<S?1:0,(R=(k=(C=0!=N?Math.abs((N-q)/N):C)<U?C*U:1)<b?1:0)||G)){for(D=0;D<s;D++)Q[D]=a[D];for(L=N,O=z=0;;){if(I&&0==(I=0)&&R&&(!G||k<F));else{if(v(e,s,h,T,A,u,l,j,o,H,B,a),w=j.a,y=j.b,h.NZ>0)return;if(Z=z=1,S*=.25,O||!R)Z=0;else for(D=0;D<s;D++)a[D]=Q[D]}if(0!=Z){if(j.a=L,Z=d(e,h,j,s,o,l,u,a,H),L=j.a,h.NZ>0)return;if(O=1,b*=.25,0!=Z){T=-(L+L),A=L*L;continue}}for(D=0;D<s;D++)a[D]=Q[D];if(!G||z)break}p(l,g,n,o,u,j),V=f(e,s,w=j.a,y=j.b,B,a,g,n,H)}x=E,q=N,M=_,U=C}}function y(e,r,t,i){var n,a,s,o,l,u,p,f,c,m,h,v,d,y,b,S,q,U,M,x,L,N,C,k=e.Degree,_=.017453292519943295,F=Math.LN2,T=e.Degree+1,A=new Array(T),E=new Array(T),I=new Array(T),D=new Array(T),P=new Object,R=new Object;v=1;do{a=v,d=1+(v/=2)}while(d>1);var O=Number.MIN_VALUE/a,V=Math.cos(94*_),G=Math.sin(94*_),z=Math.sqrt(.5),j=-z;for(R.NZ=U=0,R.szr=R.szi=R.lzr=R.lzi=0;0==r[k];)t[U]=i[U]=0,k--,U++;for(N=k+1;k>=1;){if(k<=2){k<2?(t[e.Degree-1]=-r[1]/r[0],i[e.Degree-1]=0):(P.li=P.lr=P.si=P.sr=0,g(r[0],r[1],r[2],P),t[e.Degree-2]=P.sr,i[e.Degree-2]=P.si,t[e.Degree-1]=P.lr,i[e.Degree-1]=P.li);break}for(p=0,f=Number.MAX_VALUE,B=0;B<N;B++)(m=Math.abs(r[B]))>p&&(p=m),0!=m&&m<f&&(f=m);if(((c=O/f)<=1&&p>=10||c>1&&Number.MAX_VALUE/c>=p)&&(c=0==c?Number.MIN_VALUE:c,x=Math.floor(Math.log(c)/F+.5),1!=(l=Math.pow(2,x))))for(B=0;B<N;B++)r[B]*=l;for(var B=0;B<N;B++)E[B]=Math.abs(r[B]);E[k]=-E[k],L=k-1,m=Math.exp((Math.log(-E[k])-Math.log(E[0]))/k),0!=E[L]&&(m=(h=-E[k]/E[L])<m?h:m),h=m;do{for(h=.1*(m=h),u=E[0],B=1;B<N;B++)u=u*h+E[B]}while(u>0);o=m;do{for(s=u=E[0],B=1;B<k;B++)s=m*s+(u=m*u+E[B]);m-=o=(u=m*u+E[k])/s}while(Math.abs(o/m)>.005);for(n=m,B=1;B<k;B++)A[B]=(k-B)*r[B]/k;for(A[0]=r[0],v=r[k],d=r[L],C=0==A[L]?1:0,M=0;M<5;M++)if(y=A[L],C){for(B=0;B<L;B++)A[U=L-B]=A[U-1];A[0]=0,C=0==A[L]?1:0}else{for(S=-v/y,B=0;B<L;B++)A[U=L-B]=S*A[U-1]+r[U];A[0]=r[0],C=Math.abs(A[L])<=Math.abs(d)*a*10?1:0}for(B=0;B<k;B++)D[B]=A[B];for(M=1;M<=20;M++){if(q=-G*j+V*z,j=G*z+V*j,w(a,T,20*M,b=n*(z=q),n,A,k,r,N,I,-2*b,R),0!=R.NZ){for(t[U=e.Degree-k]=R.szr,i[U]=R.szi,k=(N-=R.NZ)-1,B=0;B<N;B++)r[B]=I[B];1!=R.NZ&&(t[U+1]=R.lzr,i[U+1]=R.lzi);break}for(B=0;B<k;B++)A[B]=D[B]}if(M>20){e.Degree-=k;break}}}y(l,s,u,o);var b=o.length;for(S=0;S<b;S++){var q=h(o[S],i+8),U=h(u[S],i+8),M=q<0?"-":"";0===(U=i-String(U).length>2?U:u[S])&&(U=""),0===q&&(q=""),q=1===Math.abs(q)?M+"i":q?q+"*i":"";var x=U&&q?U+"+"+q:U+q;u[S]=x.replace(/\+\-/g,"-")}return u}(r,0,a).concat(n),o=0;o<0;o++)s.unshift(0);return s};if(r instanceof w&&r.isPoly()){if(r.distributeMultiplier(),r.group===l){var o=e.Utils.arrayMin(f(r.symbols)),u=r.symbols[o].clone().toUnitMultiplier();r=t.expand(t.divide(r,u)),n.push(0)}if(r.group===e.groups.S)return[0];if(r.group===e.groups.PL){var p=f(r.symbols),c=e.Utils.arrayMin(p);r=e.PARSER.divide(r,e.PARSER.parse(r.value+"^"+c))}for(var m=f(r.symbols).sort().pop(),g=r.group===e.groups.PL?r.symbols:r.symbols[m],v=g.group,d=(p=v===a?[g.power.toDecimal()]:f(g.symbols),[]),b=e.Utils.arrayMax(p),S=1;S<=b;S++){var q=0;-1!==p.indexOf(S+"")&&(q=v===a?g.multiplier:g.symbols[S].multiplier),d.unshift(q)}return d.push(r.symbols[y].multiplier),g.group===a&&(d[0]=g.multiplier),s(d,0,b)}if(e.Utils.isArray(r)){var U=r,M=(d=[],p=[],0);for(S=0;S<U.length;S++){for(var x=U[S][0],L=U[S][1],N=L-M-1,C=0;C<N;C++)d.unshift(0);d.unshift(x),0!==L&&p.push(L),M=L}return s(d,0,b=Math.max.apply(void 0,p))}throw new e.exceptions.NerdamerTypeError("Cannot calculate roots. Symbol must be a polynomial!")},roots:function(r){if(r.isConstant(!0,!0))return e.Utils.nroots(r);var i=M.proots(r).map((function(e){return t.parse(e)}));return e.Vector.fromArray(i)},froot:function(r,t,i){return function(t){for(var n=i||e.Utils.build(e.Calculus.diff(r.clone())),a=r instanceof Function?r:e.Utils.build(r),s=!1,o=0;!s;){var l=t-a(t)/n(t),u=Math.abs(l)-Math.abs(t);t=l,Math.abs(u)<1e-12?s=!0:o>1e4&&(t=null,s=!0),o++}return t}(Number(t))},quad:function(e,r,i){var n=function(e,r,i,n){return t.parse("-("+r+"+"+n+"*sqrt(("+r+")^2-4*("+e+")*("+i+")))/(2*"+e+")")};return[n(e,r,i,1),n(e,r,i,-1)]},sumProd:function(e,r){return M.quad(-r,e,-1).map((function(e){return e.invert()}))},coeffs:function(e,r,i){r=String(r),e=t.expand(e),i=i||[new w(0)],e.group===s&&e.contains(r,!0)&&t.error("Unable to get coefficients using expression "+e.toString());var n=m(e);if(1!==n.length||n[0]!==r||e.isImaginary())if(r||t.error("Polynomial contains more than one variable. Please specify which variable is to be used!"),-1===n.indexOf(r))i[0]=t.add(e,i[0]);else if(i=i||[new w(0)],e.group===p){var a=e.symbols[r];a||t.error("Expression is not a polynomial!");var o=Number(a.power);((h=t.divide(e.clone(),a.clone())).contains(r,!0)||o<0||!d(o))&&t.error("Expression is not a polynomial!"),(g=i[o])&&(h=t.add(g,h)),i[o]=h}else e.group===u&&e.each((function(e){M.coeffs(e.clone(),r,i)}),!0);else for(var l=new S(e).coeffs.map((function(e){return new w(e)})),f=0,c=l.length;f<c;f++){var g,h=l[f];(g=i[f])&&(h=t.add(g,h)),i[f]=h}for(f=0,c=i.length;f<c;f++)void 0===i[f]&&(i[f]=new w(0));return i},polyPowers:function(r,t,n){if(n=n||[],(c=c=r.group)===l&&t===r.value)n=n.concat(f(r.symbols));else if(c===u)for(var s in r.symbols){var o=r.symbols[s],c=o.group,m=o.value;if(c===a&&t===m)n.push(o.power);else if(c===l||c===u)n=M.polyPowers(o,t,n);else if(c===p&&o.contains(t)){var g=o.symbols[t];g&&n.push(g.power)}else c!==i&&t===m||n.push(0)}else c===p&&r.contains(t)&&n.push(e.Utils.decompose_fn(r,t,!0).x.power);return e.Utils.arrayUnique(n).sort()},Factor:{split:function(e){var r=new w(1),i=new w(1);return M.Factor.factor(e,new q).each((function(e){var n=t.parse(e);e.isConstant(!0)?r=t.multiply(r,n):i=t.multiply(i,n)})),[r,i]},mix:function(e,r){for(var t=f(e),i=t.length,n=[],a=0;a<i;a++){for(var s=t[a],o=e[s],l=n.length,u=0;u<l;u++){var p=n[u]*s;n.push(p),r&&n.push(-p)}for(u=1;u<=o;u++)n.push(Math.pow(s,u))}return n},common:function(r,i){try{if(r.group===u){for(var n=t.expand(r.clone(),!0).collectSymbols(null,null,(function(e,r){return(r.length||1)-(e.length||1)})),a={},s=[],o=0;o<n.length;o++){var l=n[o];s.push(l.multiplier.clone()),l.each((function(e){var r=Number(e.power);if(isNaN(r))throw new Error("exiting");e.value in a?(r<a[e.value][0]&&(a[e.value][0]=r),a[e.value][1].push(e)):a[e.value]=[r,[e]]}))}var p=new w(1);for(var f in a)a[f][1].length===n.length&&(p=t.multiply(p,t.pow(new w(f),new w(a[f][0]))));var c=e.Math2.QGCD.apply(null,s);if(!c.equals(1))for(i.add(new w(c)),o=0;o<n.length;o++)n[o].multiplier=n[o].multiplier.divide(c);if(!p.equals(1))for(i.add(p),r=new w(0),o=0;o<n.length;o++)r=t.add(r,t.divide(n[o],p.clone()))}}catch(m){}return r},zeroes:function(r,i){var n=function(){throw new e.exceptions.ValueLimitExceededError("Exiting")};try{var a,s,o,l,p;p=(r=t.expand(r.clone())).toString(),a=m(r),o=new w(0);for(var f=[],c=[],g=0,h=a.length;g<a.length;g++){for(var y={},b=0;b<h;b++)g!==b&&(y[a[b]]=0);var S=(s=t.parse(p,y)).power;d(S)||n(),f.push(s),c.push(s.power)}if(e.Utils.allSame(c)){var q=r.length,U=f.length;2===U&&(l=new v(c[0]/(q-1))),3===U&&(l=new v(c[0]/Math.round((Math.sqrt(8*q-1)-3)/2)))}else l=e.Math2.QGCD.apply(null,c);for(d(l)||n(),g=0;g<f.length;g++){var x=f[g],L=x.power.clone().divide(l);x.multiplier=new v(Math.pow(x.multiplier,1/L)),x.power=l.clone(),o=t.add(o,x)}if(o.group!==u)return r;for(;;){var N=M.div(r.clone(),o.clone());if(!N[1].equals(0))break;if(r=N[0],i.add(o.clone()),r.equals(1))break}}catch(C){}return r},factor:function(r,i){if(r.isConstant())return e.Math2.factor(r);var n=t.parse(r),a=M.Factor._factor(n,i);if(a.equals(r))return a;if(a.group===p){var s=new w(1),o=t.parse(a.power),l=t.parse(a.multiplier);a.toUnitMultiplier(),a.multiplier.lessThan(0)&&(s.negate(),a.negate()),a.each((function(e){var r=t.parse(M.Factor._factor(e));r.group===p?(l=t.multiply(l,w.create(r.multiplier)),r.each((function(e){var r=t.parse(M.Factor._factor(e));s=t.multiply(s,r),r.group===p&&(l=t.multiply(l,w.create(r.multiplier)))}))):s=t.multiply(s,r)})),a=t.pow(t.multiply(l,s),o)}return a},quadFactor:function(r,i){if(r.isPoly()&&M.degree(r.equals(2))){var n=e.Utils.variables(r)[0],a=M.coeffs(r,n),s=M.Factor._factor(a[2].clone());if(s.group===p){var o=s.collectSymbols();if(o.length>2)return r;var l=t.multiply(t.parse(a[0]),t.parse(o[0])),u=t.parse(a[1]).negate(),f=t.parse(o[1]),c=M.quad(f,u,l).filter((function(r){if(e.Utils.isInt(r))return r}));if(1===c.length){var m=c[0],h=t.divide(a[0],t.parse(m));e.Utils.isInt(h)&&(i.add(t.parse(g("({0})*({1})+({2})",o[1],n,h))),i.add(t.parse(g("({0})*({1})+({2})",o[0],n,m))),r=new w(1))}}}return r},cubeFactor:function(e,r){if(e.isComposite()){var i=e.collectSymbols();if(2===i.length){var n=i[0].sign(),a=i[0].clone().abs(),s=i[1].sign(),o=i[1].clone().abs();if(a.isCube()&&o.isCube()){n<s&&([n,s]=[s,n],[a,o]=[o,a]);var l=t.parse(a.getNth(3)),u=t.parse(o.getNth(3)),p=t.multiply(t.expand(t.pow(a.clone().toUnitMultiplier(),t.parse("1/3"))),l),f=t.multiply(t.expand(t.pow(o.clone().toUnitMultiplier(),t.parse("1/3"))),u);1===n&&-1===s?(r.add(t.parse(g("(({0})-({1}))",p,f))),r.add(t.parse(g("(({0})^2+({0})*({1})+({1})^2)",p,f))),e=w(1)):1===n&&1===s&&(r.add(t.parse(g("(({0})+({1}))",p,f))),r.add(t.parse(g("(({0})^2-({0})*({1})+({1})^2)",p,f))),e=w(1))}}}return e},_factor:function(r,i){if(r.group===o){var n=r.args[0];if(n.group===a&&n.isSimple())return r}else if(r.group===a&&r.isSimple())return r;if(r.group===u){r.distributeMultiplier(!0);var s=new w(0);r.each((function(e){(e.group===u&&e.power.greaterThan(1)||e.group===p)&&(e=t.expand(e)),s=t.add(s,e)})),s.power=r.power,r=s}r.group===o&&"sqrt"!==r.fname&&(r=e.Utils.evaluate(r));var l=r.clone();try{if(r.group===p){var g,h,v,y,b,S,U=t.parse(r.power);if(g=M.Simplify.strip(r.getDenom()),h=M.Simplify.strip(r.getNum()),v=g.pop(),(y=h.pop()).equals(r))return r;S=M.Factor.factor(y),b=M.Factor.factor(v);var x=M.Simplify.unstrip(h,S),L=M.Simplify.unstrip(g,b);return t.divide(x,L)}if(r.group===a)return r;if(r.isConstant())return r.equals(1)?r.clone():e.Math2.factor(r);if(U=r.power.clone(),d(U)&&(!U.lessThan(0)||r.group!==o)){var N=U.sign();r.toLinear(),i=i||new q;var C={};r=t.parse(e.Utils.subFunctions(r,C)),f(C).length>0&&(i.preAdd=function(r){return t.parse(r,e.Utils.getFunctionsSubs(C))}),r.isLinear()||(i.pFactor=r.power.toString(),r.toLinear());var k=m(r);r.isImaginary()&&k.push(e.Settings.IMAGINARY);var _=k.length>1;if(_){var F=!0,T=!0;if(r.each((function(e){e.group!==a&&(F=!1),e.multiplier.equals(1)||(T=!1)})),F&&T)return t.pow(t.parse(r,e.Utils.getFunctionsSubs(C)),t.parse(U))}var A=new q;r=M.Factor.coeffFactor(r,A),A.each((function(e){c(U)&&e.lessThan(0)&&e.negate(),N<0&&e.invert(),i.add(e)}));var E=new q;if(r=M.Factor.powerFactor(r,E),E.each((function(e){N<0&&e.invert(),i.add(e)})),_)r=M.Factor.cubeFactor(r,i),r=M.Factor.mfactor(r,i),i.each((function(e){N<0&&e.power.negate()}));else{var I=k[0];r=M.Factor.squareFree(r,i,I);var D=new q;r=M.Factor.trialAndError(r,D,I);var P=D.toSymbol();if(P.equals(l))return P;for(var R in D.factors){var O=D.factors[R];i.add(t.pow(O,t.parse(U)))}r.equals(l)&&(r=M.Factor.quadFactor(r,i))}return r=t.parse(r,e.Utils.getFunctionsSubs(C)),i.add(t.pow(r,t.parse(U))),i.toSymbol()}return r}catch(V){return l}},reduce:function(e,r){if(e.group===u&&2===e.length){var i=e.collectSymbols().sort((function(e,r){return r.multiplier-e.multiplier}));if(i[0].power.equals(i[1].power)){var n=t.parse(i[0].power),a=i[0].clone().toLinear(),s=i[1].clone().toLinear();r.add(t.add(a.clone(),s.clone())),s.negate();for(var o=Number(n),l=new w(0),p=1;p<=o;p++){var f=t.pow(a.clone(),t.subtract(n.clone(),new w(p))),c=t.pow(s.clone(),t.subtract(new w(p),new w(1)));l=t.add(l,t.multiply(f,c))}return l}}return e},squareFree:function(e,r,t){if(e.isConstant()||e.group===a)return e;var i=new S(e,t).squareFree(),n=i[2];if(1!==n){var s=i[1].toSymbol();return s.power=s.power.multiply(new v(n)),r.add(M.Factor.factor(s)),M.Factor.squareFree(i[0].toSymbol(),r)}return e},powerFactor:function(r,i){if(r.group!==l||r.previousGroup===s)return r;var n=f(r.symbols);if(!e.Utils.allNumeric(n))return r;var a=e.Utils.arrayMin(n),o=new w(0),u=t.parse(r.value+"^"+a);return r.each((function(e){e=t.divide(e,u.clone()),o=t.add(o,e)})),i.add(u),o},coeffFactor:function(r,t){if(r.isComposite()){var i=e.Math2.QGCD.apply(null,r.coeffs());if(i.equals(1)){var n=function(e){var r;return e.group===p?(r=0,e.each((function(e){r+=e.power}))):r=Number(e.power),r},a=r.collectSymbols(null,null,null,!0).sort((function(e,r){return e.isConstant(!0)?1:r.power-e.power})),s=a[0];(n(s)>n(a[1])||a[1].isConstant(!0))&&s.multiplier.lessThan(0)&&(t.add(new w(-1)),r.each((function(e){e.negate()}),!0))}else r.each((function(e){e.isComposite()?e.each((function(e){e.multiplier=e.multiplier.divide(i)})):e.multiplier=e.multiplier.divide(i)})),r.updateHash();t&&t.add(new w(i))}return r},trialAndError:function(r,t,i){var n=r.clone();try{var s=[];if(r.isConstant()||r.group===a)return r;for(var o=new S(r,i),l=o.coeffs[0],u=e.Math2.ifactor(l),p=M.proots(r),f=0;f<p.length;f++){var c=p[f],m=1;if(!isNaN(c)){for(var g in u){var h=e.Utils.round(Math.log(g)/Math.log(Math.abs(c)),8);if(d(h)){c=g,m=h;break}}var w=new v(c),y=[new v(w.num).negate()];y[m]=new v(w.den);var b=S.fromArray(y,o.variable).fill(),q=o.divide(b);q[1].equalsNumber(0)&&(o=q[0],s.push(b.toSymbol()))}}return o.equalsNumber(1)||(o=M.Factor.search(o,t)),s.forEach((function(e){t.add(e)})),o.toSymbol()}catch(U){return n}},search:function(r,t,i){i=i||10;var n=r.variable,a=function(e,a,s,o){var l=S.fit(e,a,s,i,o,n);if(l&&l.coeffs.length>1){var u=r.divide(l);if(u[1].equalsNumber(0))return t.add(l.toSymbol()),[u[0],l]}return null},s=r.coeffs[0],o=e.Math2.ifactor(s),l=r.lc(),u=e.Math2.ifactor(l),p=r.sub(i),f=e.Math2.ifactor(p),c=M.Factor.mix(f,p<0),m=Math.ceil(r.coeffs.length/2),g=l.lessThan(0),h=s.lessThan(0);for(u[1]=1,o[1]=1;m--;)for(var v in u)for(var d in o)for(var w=0;w<c.length;w++){var y=a(v,d,c[w],m);if(y)return r=y[0],e.Utils.isPrime(r.sub(i))||(r=M.Factor.search(r,t)),r;y||(g&&h?y=a(-v,-d,c[w],m):g?y=a(-v,d,c[w],m):h&&(y=a(v,-d,c[w],m)))}return r},mSqfrFactor:function(r,t){if(r.group!==o)for(var i=m(r).reverse(),n=0;n<i.length;n++)do{if(i[n]!==r.value){var a=e.Calculus.diff(r,i[n]),s=M.Factor.coeffFactor(a);if(s.equals(0))break;var l=!0;if(s.isConstant()&&r.isComposite()&&r.each((function(e){e.multiplier%s!=0&&(l=!1)}),!0),l){var u=M.div(r,s.clone()),p=u[1].equals(0);if(u[0].isConstant()){t.add(u[0]);break}}else p=!1;p&&(t.add(u[0]),r=s)}else t.add(r),r=new w(1)}while(p);return r},sqdiff:function(r,i){if(r.isConstant("all"))return r;try{var n=function(r){return e.Utils.block("POSITIVE_MULTIPLIERS",(function(){return w.unwrapPARENS(b.sqrt(b.abs(r)))}),!0)},s=e.Utils.separate(r.clone()),o=[];for(var l in s)"constants"!==l&&o.push(s[l]);if(o.sort((function(e,r){return r.power-e.power})),2===o.length){var u,p;if(u=o.pop(),p=o.pop(),c(u.power)&&c(p.power)&&u.sign()===p.sign()&&u.group===a&&p.group===a)throw new Error("Unable to factor");if(u.isComposite()&&p.power.equals(2)){p=n(p);var f=M.Factor.factor(t.add(u,s.constants));f.power.equals(2)&&(f.toLinear(),i.add(t.subtract(f.clone(),p.clone())),i.add(t.add(f,p)),r=new w(1))}else if(u=u.powSimp(),p=p.powSimp(),(u.group===a||""===u.fname)&&u.power.equals(2)&&(p.group===a||""===p.fname)&&p.power.equals(2)&&!s.constants){if(u.multiplier.lessThan(0)){var m=p;p=u,u=m}u.multiplier.greaterThan(0)&&(u=n(u),p=n(p)),i.add(t.subtract(u.clone(),p.clone())),i.add(t.add(u,p)),r=new w(1)}}}catch(g){}return r},mfactor:function(r,i){if(r.group===o)if("sqrt"===r.fname){var n=new q,a=M.Factor.common(r.args[0].clone(),n);a=M.Factor.coeffFactor(a,n),r=t.multiply(t.symfunction("sqrt",[a]),t.parse(r.multiplier)),n.each((function(i){r=t.multiply(r,t.parse(e.Utils.format("sqrt({0})",i)))}))}else i.add(r);else{r=M.Factor.mSqfrFactor(r,i);for(var s=m(r),l=r.collectSymbols().map((function(e){return w.unwrapSQRT(e)})),u={},p={},f=s.length,c=l.length,g=0;g<f;g++){var h=s[g];u[h]=new w(0);for(var v=0;v<c;v++){var y=l[v];if(y.contains(h)){var b=y.value===h?y.power.toDecimal():y.symbols[h].power.toDecimal();(!p[h]||b<p[h])&&(p[h]=b),u[h]=t.add(u[h],y.clone())}}}for(var S in u){var U=t.parse(S+"^"+p[S]),x=t.divide(u[S],U),L=t.expand(x);if(L.equals(1))break;var N=M.div(r.clone(),L);if(N[0].equals(0))break;if(N[1].equals(0)){var C=!1;if(N[0].each((function(e){d(e.multiplier)||(C=!0)})),C){N[1]=t.expand(t.multiply(N[1],L));break}}var k=d(L)&&L.lessThan(0);if(N[1].equals(0)&&!k){var _=M.div(r.clone(),N[0].clone());if((U=_[0]).equals(0))return r;if(r=_[1],U.equals(-1)&&!r.equals(0))return r;var F=N[0];if(r.equals(F)){var T=M.Factor.reduce(F,i);return r.equals(T)?T:M.Factor.mfactor(T,i)}return i.add(F),r.equals(0)?U:U.isConstant("all")?(i.add(U),U):M.Factor.mfactor(U,i)}}}return r=M.Factor.sqdiff(r,i),r=M.Factor.zeroes(r,i)}},allLinear:function(e){for(var r=e.length,t=0;t<r;t++)if(!M.isLinear(e[t]))return!1;return!0},isLinear:function(e){var r=!1,t=e.group;if(t===l||t===u)for(var n in r=!0,e.symbols){var f=e.symbols[n],c=f.group;if(c!==o&&c!==s||(r=!1),c===p)r=1===m(f).length;else if(c===l||c===u)r=M.isLinear(f);else if(f.group!==i&&"1"!==f.power.toString()){r=!1;break}}else t===a&&1===e.power&&(r=!0);return r},gcd:function(){var r;if(0===(r=1===arguments.length&&arguments[0]instanceof e.Vector?arguments[0].elements:e.Utils.arguments2Array(arguments)).length)return new w(1);if(1===r.length)return r[0];for(var i=[],n=!1,a=0;a<r.length;a++)if(r[a].group===o&&"gcd"===r[a].fname)(r=r.concat(arguments[a].args)).splice(a,1);else{var s=m(r[a]);if(e.Utils.haveIntersection(s,i)){n=!0;break}i=i.concat(s)}if(n||0===i.length){if(r.every((function(e){return e.getDenom().equals(1)}))){var l=r[0];for(a=1;a<r.length;a++)l=M.gcd_(r[a],l);return l}return t.divide(M.gcd.apply(null,r.map((function(e){return e.getNum()}))),M.lcm.apply(null,r.map((function(e){return e.getDenom()}))))}return t.symfunction("gcd",r)},gcd_:function(r,i){if(r.group!==o&&r.group!==n||(r=e.Utils.block("PARSE2NUMBER",(function(){return t.parse(r)}))),i.group===o&&(i=e.Utils.block("PARSE2NUMBER",(function(){return t.parse(i)}))),r.isConstant()&&i.isConstant())return new w(e.Math2.QGCD(new v(+r),new v(+i)));var a=t.multiply(r.getDenom()||new w(1),i.getDenom()||new w(1)).invert();if(r=t.multiply(r.clone(),a.clone()),i=t.multiply(i.clone(),a.clone()),r=t.expand(r),i=t.expand(i),r.group===p||i.group===p){var l=t.divide(r.clone(),i.clone());if(!(g=t.multiply(i.clone(),l.getDenom().invert())).equals(1))return g}if(r.group===s||i.group===s){var u=new w(e.Math2.GCD(r.multiplier,i.multiplier)),f=M.gcd_(r.value===y?new w(1):t.parse(r.value),i.value===y?new w(1):t.parse(i.value)),c=M.gcd_(t.parse(r.power),t.parse(i.power));return t.multiply(u,t.pow(f,c))}if(r.length<i.length){var g=r;r=i,i=g}var h=m(r),d=m(i);if(h.length===d.length&&1===h.length&&h[0]===d[0]||1===h.length&&0===d.length||0===h.length&&1===d.length)return r=new S(r),i=new S(i),t.divide(r.gcd(i).toSymbol(),a);var b,q=[];for(r.each((function(e){q.push(e.multiplier)})),i.each((function(e){q.push(e.multiplier)}));!i.equals(0);){if(g=i.clone(),r=r.clone(),b=M.div(r,g),i=b[1],b[0].equals(0))return t.divide(new w(e.Math2.QGCD(r.multiplier,i.multiplier)),a);r=g}var U=e.Math2.QGCD.apply(void 0,q);return U.equals(1)||r.each((function(e){e.multiplier=e.multiplier.divide(U)})),!r.equals(1)||r.isConstant()||i.isConstant()?t.divide(r,a):t.divide(t.symfunction("gcd",arguments),a)},lcm:function(){var r;1===arguments.length?arguments[0]instanceof e.Vector?r=arguments[0].elements:t.error("lcm expects either 1 vector or 2 or more arguments"):r=e.Utils.arguments2Array(arguments);var i,n=r.reduce((function(e,r){return t.multiply(e,r.clone())}),new w(1)),a=function(e,r){r=Number(r);var t,i,n,a=[],s=Math.pow(2,e.length);for(i=r;i<s;i++){t=[],n=e.length-1;do{0!=(i&1<<n)&&t.push(e[n])}while(n--);t.length===r&&a.push(t)}return a}(arguments,arguments.length-1).map((function(e){return e.reduce((function(e,r){return t.multiply(e,r.clone())}),new w(1))}));i=r.every((function(r){return e.Utils.isVariableSymbol(r)}))?t.symfunction("gcd",e.Utils.arrayUnique(a)):M.gcd.apply(null,a);var s=t.divide(n,i);return s},divide:function(r,i){var n,a,s,o;return(o=(s=e.Algebra.Factor.factor(r.clone())).getDenom()).isConstant("all")?o=new w(1):r=t.expand(w.unwrapPARENS(t.multiply(s,o.clone()))),n=M.div(r,i),a=t.divide(n[1],i),t.divide(t.add(n[0],a),o)},div:function(r,i){var n,s,o=[new w(0),r.clone()];try{if(i.isConstant("all"))return r.each((function(e){e.multiplier=e.multiplier.divide(i.multiplier)})),[r,new w(0)];if(r=t.expand(r),i=t.expand(i),r.group===a&&i.group===u){var l=r.value,p=e.Utils.decompose_fn(i.clone(),l,!0);if(r.isLinear()&&p.x&&p.x.isLinear()&&i.isLinear()){var f=w.create(r.multiplier);return[t.divide(f.clone(),p.a.clone()),t.divide(t.multiply(f,p.b),p.a).negate()]}}if(r.group===a&&i.group===a){var c=t.divide(r.clone(),i.clone());return c.isConstant()?[c,new w(0)]:[new w(0),r.clone()]}var g=r.hasFunc(),h=i.hasFunc(),d=!1;if(g||h){d=!0;var b={},q=(r=t.parse(e.Utils.subFunctions(r,b)),i=t.parse(e.Utils.subFunctions(i,b)),e.Utils.getFunctionsSubs(b))}var M,x,L=e.Utils.arrayUnique(m(r).concat(m(i)));if((r.isImaginary()||i.isImaginary())&&L.push(e.Settings.IMAGINARY),1===L.length)M=(Y=new S(r).divide(new S(i)))[0].toSymbol(),x=Y[1].toSymbol();else{L.push(y);var N=function(e){for(var r=new w(0),i=0;i<e.length;i++){var n=e[i].toSymbol();r=t.add(r,n)}return r},C=function(e,r){var t,i=Math.max.apply(null,e.terms),n=0;if(!r)for(var a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)&&(t=a,n++),n>1)return;if(r)for(a=0;a<e.terms.length;a++)if(e.terms[a].equals(i)){t=a;break}return[i,t,e]},k=function(e,r){var t=e[r=r||0],i=e.length;if(t){for(var n,a,s=C(t),o=r+1;o<i;o++){var l=e[o],u=t.sum.equals(l.sum);if(!u&&s)break;if(u){for(var p,f,c,m,g=t.terms.length,h=0;h<g;h++){var v=t.terms[h],d=l.terms[h];(void 0===p||v.greaterThan(p))&&(p=v,c=h),(void 0===f||d.greaterThan(f))&&(f=d,m=h)}var w=p.subtract(l.terms[c]),y=f.subtract(t.terms[m]);if(y>w){s=[f,m,l];break}if(w>y){s=[p,c,t];break}}else if(s=C(l))break;s=C(l)}if(!s)return C(e[0],!0);for(o=0;o<E.length;o++){var b=E[o].terms;if((a=s[1])===b.length-1)return;if(!(n=b[a]).equals(0))break}return n.equals(0)?k(e,++r):s}},_=e.Utils.toMapObj(L),F=function(e,r){return r.sum.subtract(e.sum)},T=function(e,r){if(!e||!r)return!1;for(var t=0;t<e.terms.length;t++)if(e.terms[t].lessThan(r.terms[t]))return!1;return!0},A=r.tBase(_).sort(F),E=i.tBase(_).sort(F),I=T(A[0],E[0])&&A[0].count>E[0].count?E:A,D=k(I),P=[];if(D){var R=D[1],O=function(e,r){var t=e.len(),i=r.len(),n=r.terms[R],a=e.terms[R];return i>t&&n.greaterThan(a)?i-t:n.subtract(a)};R=function(e,r,t){for(var i=[],n=0;n<e.length;n++)for(var a=e[n],s=0;s<a.terms.length;s++){var o=i[s],l=a.terms[s];0===n?i[s]=l:o&&!o.equals(l)&&(i[s]=void 0)}for(n=0;n<i.length;n++)if((a=i[n])&&!a.equals(0))return n;return t}(A,0,R),A.sort(O),E.sort(O);var V=E[0],G=A[0],z=new U(new v(1),[],G.map);if(V.sum.greaterThan(G.sum)&&G.len()>1)for(var j=0;j<G.terms.length;j++){var B=V.terms[j].subtract(G.terms[j]);if(B.equals(0))z.terms[j]=new v(0);else{var H=B.add(new v(1));z.terms[j]=B;for(var Q=0;Q<A.length;Q++)A[Q].terms[j]=A[Q].terms[j].add(H)}}for(var Z=T(A[0],E[0]),X=0;Z&&(s=E,!(n=A)[0].sum.equals(s[0].sum)||n.length>=s.length);){if(X++>200)throw new e.exceptions.InfiniteLoopError("Unable to compute!");var Y=A[0].divide(E[0]);for(P.push(Y),A.shift(),j=1;j<E.length;j++){var J=E[j].multiply(Y).generateImage(),K=A.length;for(0===K&&(J.coeff=J.coeff.neg(),A.push(J),A.sort(O)),Q=0;Q<K;Q++){var W=A[Q];if(W.getImg()===J.getImg()){W.coeff=W.coeff.subtract(J.coeff),W.coeff.equals(0)&&(e.Utils.remove(A,Q),Q--);break}Q===K-1&&(J.coeff=J.coeff.neg(),A.push(J),A.sort(O))}}if(!(Z=T(A[0],E[0]))&&A.length>=E.length)for(j=1;j<A.length;j++)if(Z=T(A[j],E[0])){A.unshift(e.Utils.remove(A,j));break}}}M=N(P),x=N(A),void 0!==z&&(z=z.toSymbol(),M=t.divide(M,z.clone()),x=t.divide(x,z))}return d&&(M=t.parse(M.text(),q),x=t.parse(x.text(),q)),[M,x]}catch($){return o}},line:function(r,i,n){e.Utils.isArray(r)&&(r=e.Utils.convertToVector(r)),e.Utils.isArray(i)&&(i=e.Utils.convertToVector(i)),n=t.parse(n||"x"),e.Utils.isVector(r)&&e.Utils.isVector(i)||t.error('Line expects a vector! Received "'+r+'" & "'+i+'"');var a=t.subtract(i.e(1).clone(),r.e(1).clone()),s=t.subtract(i.e(2).clone(),r.e(2).clone()),o=t.divide(s,a),l=t.multiply(n,o.clone()),u=t.multiply(r.e(1).clone(),o);return t.add(t.subtract(l,u),r.e(2).clone())},PartFrac:{createTemplate:function(e,r,i,n){var s,l,u,p,f,c,m;(e=M.Factor.factor(e)).each((function(r,t){if(r.group===o&&""===r.fname&&r.args[0].group===a){var i=r.args[0];this.symbols?(delete this.symbols[t],this.symbols[i.value]=i):e=r.args[0]}})),s=r.collectFactors(),l=[],c=[],m=new w(1);for(var g=0;g<s.length;g++){var h=w.unwrapPARENS(s[g]);if(h.power.greaterThan(1)){p=Number(h.power),u=h.clone().toLinear(),f=Number(M.degree(u,n));for(var v=0;v<p;v++){var d=t.pow(u.clone(),new w(v+1));i.push(d.clone());var y=t.divide(e.clone(),d.clone());c.push(f),l.push(y)}}else f=Number(M.degree(h,n)),i.push(h),y=t.divide(e.clone(),h.clone()),y=t.expand(w.unwrapPARENS(y)),c.push(f),l.push(y)}return[i=i.map((function(e){return t.multiply(e,m.clone())})),l,c]},partfrac:function(r,i,n){var a=m(r);i=i||t.parse(a[0]);try{var s,o,l,u,p,f,c,g,h,v,d,y,b,S,q,U,x,L,N;if(s=t.expand(r.getNum()),o=t.expand(r.getDenom().toUnitMultiplier()),s.multiplier=r.multiplier,p=s.groupTerms(i),Number(M.degree(s,i))>=Number(M.degree(o,i))?(b=(y=M.div(s.clone(),t.expand(o.clone())))[0],p=(s=y[1]).groupTerms(i)):b=new w(0),1===Number(M.degree(o,i))){var C=t.divide(s,o);return n?[b,C]:t.add(b,C)}u=M.Factor.factor(o),U=M.PartFrac.createTemplate(o.clone(),u,[],i),x=U[0],S=U[1],f=U[2],d=[p.length],c=[],l=[],q=[],S.map((function(e,r){L=x[r],N=f[r];for(var n=0;n<N;n++){l.push(L.clone());var a=w.create(i,n),s=t.expand(t.multiply(e,a.clone())).groupTerms(i),o=s.length;d.push(o),c.push(s),q.push(a.clone())}})),g=e.Utils.arrayMax(d),v=new e.Matrix(e.Utils.fillHoles(p,g)).transpose(),h=new e.Matrix;for(var k=0;k<c.length;k++)h.elements.push(e.Utils.fillHoles(c[k],g));var _=t.multiply(h.transpose().invert(),v),F=n?[b]:b;return _.each((function(e,r){var i=t.multiply(q[r],t.divide(e,l[r]));n?F.push(i):F=t.add(F,i)})),F}catch(I){try{if(r.isComposite()){var T={};r.each((function(e){var r=e.getDenom(),i=e.getNum(),n=T[r];T[r]=n?t.add(n,i):i}));var A=new w(0);for(var E in T)A=t.add(A,t.divide(T[E],t.parse(E)));r=A}}catch(D){}}return r}},degree:function(r,i,n){if(n=n||{nd:[],sd:[],depth:0},!i){var o=m(r);if(o.length>1)throw new Error("You must specify the variable for multivariate polynomials!");if(0===o.length)return new w(0);i=t.parse(o[0])}var l=r.group;r.isComposite()?((r=r.clone()).distributeExponent(),r.each((function(e){n.depth++,M.degree(e,i,n),n.depth--}))):r.group===p?r.each((function(e){n.depth++,M.degree(e,i,n),n.depth++})):l===s&&r.value===i.value?n.sd.push(r.power.clone()):l===a&&r.value===i.value?n.nd.push(t.parse(r.power)):n.nd.push(new w(0));var u=n.nd.length>0?e.Utils.arrayMax(n.nd):void 0;return 0===n.depth&&n.sd.length>0?(void 0!==u&&n.sd.unshift(u),t.symfunction("max",n.sd)):(e.Utils.isSymbol(u)||(u=t.parse(u)),u)},sqComplete:function(r,i,n){e.Utils.isSymbol(i)||(i=t.parse(i));var a,s,o,l,u,p,f,c,m,g,h,v=function(r){throw r=r||"Stopping",new e.exceptions.ValueLimitExceededError(r)};return r.isPoly(!0)||v("Must be a polynomial!"),m=e.Utils.inBrackets,r=r.clone(),(a=e.Algebra.degree(r,i)).equals(2)||v("Cannot complete square for degree "+a),s=(f=e.Algebra.coeffs(r,i))[2],c=f[1].sign(),o=t.divide(f[1],new w(2)),l=t.pow(o.clone(),new w(2)),n?[s,o,u]:(h=b.sqrt(s),p=t.divide(b.sqrt(l),h.clone()),u=t.subtract(f[0],t.pow(p.clone(),new w(2))),{a:g=t.parse(m(h.clone()+"*"+i+(c<0?"-":"+")+p)),c:u,f:t.add(t.pow(g.clone(),new w(2)),u.clone())})},Simplify:{strip:function(e){var r=t.parse(e.multiplier);e.toUnitMultiplier();var i=t.parse(e.power);return e.toLinear(),[r,i,e]},unstrip:function(e,r){var i=e[0],n=e[1];return t.multiply(i,t.pow(r,n))},complexSimp:function(e,r){var i,n,a,s,o,l,u,p,f;return l=e.realpart(),p=e.imagpart(),u=r.realpart(),f=r.imagpart(),i=t.multiply(l.clone(),u.clone()),n=t.multiply(p.clone(),f.clone()),a=t.multiply(u.clone(),p),s=t.multiply(l,f.clone()),o=t.add(t.pow(u,new w(2)),t.pow(f,new w(2))),t.divide(t.add(t.add(i,n),t.multiply(t.subtract(a,s),w.imaginary())),o)},trigSimp:function(r){if(r.containsFunction(["cos","sin","tan"])){r=r.clone();var i=M.Simplify.strip(r),n=(r=i.pop()).clone();if(r.group===u){var a=new w(0);r.each((function(e){var r=M.Simplify.trigSimp(e.fnTransform());a=t.add(a,r)}),!0),n=t.pow(t.multiply(new w(r.multiplier),a),new w(r.power))}else if(r.group===p){var s=r.getNum(),o=r.getDenom();if("sin"===s.fname&&"cos"===o.fname&&s.args[0].equals(o.args[0])&&s.power.equals(o.power)&&(n=t.parse(e.Utils.format("({0})*({1})*tan({2})^({3})",o.multiplier,s.multiplier,s.args[0],s.power))),n.group===p){var l=new w(1);n.each((function(r){"tan"===r.fname&&(r=t.parse(e.Utils.format("({0})*sin({1})^({2})/cos({1})^({2})",r.multiplier,M.Simplify.simplify(r.args[0]),r.power))),l=t.multiply(l,r)})),n=l}}r=n=M.Simplify.unstrip(i,n).distributeMultiplier()}return r},fracSimp:function(e){var r=e.getDenom();if((m=e.getNum()).isImaginary()&&r.isImaginary()&&(e=M.Simplify.complexSimp(m,r)),e.isComposite()){e.power>1&&(e=t.expand(e));var i,n,a,s,o,l,u,p,f,c,m,g=e.collectSymbols();for(n=g.pop();g.length;)a=g.pop(),s=t.parse(n.getDenom()),o=t.parse(a.getDenom()),l=n.getNum(),u=a.getNum(),c=t.multiply(s.clone(),o.clone()),p=t.multiply(l,o),f=t.multiply(u,s),n=t.divide(t.add(p,f),c);return r=t.expand(n.getDenom()),(i=(m=t.expand(n.getNum())).isImaginary()&&r.isImaginary()?M.Simplify.complexSimp(m,r):t.divide(m,r)).equals(e)?e:M.Simplify.simplify(i)}return e},ratSimp:function(e){if(e.group===p){var r=e.getDenom(),i=e.getNum().distributeMultiplier(),n=M.Simplify.fracSimp(r),a=M.Simplify.fracSimp(i);e=t.divide(a,n)}return e},sqrtSimp:function(e,r){if(e.isSQRT()){var n,a=M.Factor.factor(e.args[0].clone()),s=t.parse(a.multiplier),o=s.sign(),l=t.sqrt(s.abs());if(d(l)){if(a.group===p){var u=new w(1);a.each((function(e){if(e.group===i){var r=t.sqrt(e.clone());d(r)?l=t.multiply(l,r):u=t.multiply(u,e)}else u=t.multiply(u,e)}));var f=t.multiply(u,t.parse(o));(n=t.sqrt(f.clone())).isImaginary&&(n=t.sqrt(t.expand(f.clone())))}else n=t.sqrt(a.clone().toUnitMultiplier());return t.multiply(l,n)}}else e.isComposite()&&e.isLinear()?(l=new w(0),e.each((function(e){l=t.add(l,M.Simplify.sqrtSimp(e))}),!0),l=t.multiply(l,t.parse(e.multiplier))):e.group===p&&(l=t.parse(e.multiplier),e.each((function(e){var r=M.Simplify.sqrtSimp(e);l=t.multiply(l,r)}),!0),l=t.pow(l,t.parse(e.power)));return l||t.parse(e)},patternSub:function(r){var t={},i=function(e){var r=!1;return e.each((function(e){e.group===u?r=!0:e.symbols&&(r=i(e))})),r},n=function(a){a.each((function(a){if(a.symbols||a.group===o)if(i(a))n(a);else if(!t[a.value]){var s=e.Utils.getU(r);t[a.value]=s,r=r.sub(a.value,s)}}),!0)};return n(r),[r,t]},simplify:function(r){var i=M.Simplify.strip(r);if(r=i.pop(),(r=M.Simplify.fracSimp(r)).isConstant()||r.group===e.groups.S)return i.push(r),M.Simplify.unstrip(i,r);var n=r.clone();if(n=M.Simplify.trigSimp(n),n=M.Simplify.ratSimp(n),(n=M.Factor.factor(n)).group===e.groups.CP&&n.isLinear()){var a=n.multiplier.clone();n.toUnitMultiplier();var s=new w(0);n.each((function(e){var r=M.Simplify.simplify(e);s=t.add(s,r)})),n=s,s.multiplier=s.multiplier.multiply(a)}return M.Simplify.unstrip(i,n)}},Classes:{Polynomial:S,Factors:q,MVTerm:U}};e.Expression.prototype.simplify=function(){return M.Simplify.simplify(this.symbol)},r.useAlgebraDiv=function(){var r=M.divideFn=t.divide,i=0;t.divide=function(t,n){var a;return a=1==++i?e.Algebra.divide(t,n):r(t,n),i=0,a}},r.useParserDiv=function(){M.divideFn&&(t.divide=M.divideFn),delete M.divideFn},r.register([{name:"factor",visible:!0,numargs:1,build:function(){return M.Factor.factor}},{name:"simplify",visible:!0,numargs:1,build:function(){return M.Simplify.simplify}},{name:"gcd",visible:!0,numargs:[1],build:function(){return M.gcd}},{name:"lcm",visible:!0,numargs:[1],build:function(){return M.lcm}},{name:"roots",visible:!0,numargs:-1,build:function(){return M.roots}},{name:"divide",visible:!0,numargs:2,build:function(){return M.divide}},{name:"div",visible:!0,numargs:2,build:function(){return M.div}},{name:"partfrac",visible:!0,numargs:[1,2],build:function(){return M.PartFrac.partfrac}},{name:"deg",visible:!0,numargs:[1,2],build:function(){return M.degree}},{name:"coeffs",visible:!0,numargs:[1,2],build:function(){return function(){var r=M.coeffs.apply(M,arguments);return new e.Vector(r)}}},{name:"line",visible:!0,numargs:[2,3],build:function(){return M.line}},{name:"sqcomp",visible:!0,numargs:[1,2],build:function(){return function(e,r){try{return r=r||m(e)[0],M.sqComplete(e.clone(),r).f}catch(t){return e}}}}]),r.api()}(),function(r){if(void 0===t)var t=e.exports;!function(){var e=t.getCore(),r=e.PARSER,i=e.Frac,n=e.Settings,a=e.Utils.isSymbol,s=e.groups.FN,o=e.Symbol,l=e.Utils.text,u=e.Utils.inBrackets,p=e.Utils.isInt,f=e.Utils.format,c=e.Utils.even,m=e.Utils.evaluate,g=e.groups.N,h=e.groups.S,v=(s=e.groups.FN,e.groups.PL),d=e.groups.CP,w=e.groups.CB,y=e.groups.EX,b=e.groups.P,S=n.LOG,q="abs",U="sqrt",M="sin",x="cos",L="tan",N="sec",C="csc",k="cot",_="asin",F="acos",T="atan",A="asec",E="acsc",I="acot",D="sinh",P="cosh",R="tanh",O="csch",V="sech",G="coth",z="asech",j="acsch",B="acoth";function H(e){this.message=e||""}H.prototype=new Error,o.prototype.hasIntegral=function(){return this.containsFunction("integrate")},o.prototype.fnTransform=function(){if(this.group!==s)return this;var e,t=this.args[0],i=new o(this.multiplier),n=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case D:e=r.parse(f("(e^({0})-e^(-({0})))/2",t));break;case P:e=r.parse(f("(e^({0})+e^(-({0})))/2",t));break;case R:e=r.parse(f("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",t));break;case L:e=r.parse(f("sin({0})/cos({0})",t));break;case C:e=r.parse(f("1/sin({0})",t));break;case N:e=r.parse(f("1/cos({0})",t));break;default:e=n}else if(this.power.equals(2))switch(this.fname){case M:e=r.parse(f("1/2-cos(2*({0}))/2",t));break;case x:e=r.parse(f("1/2+cos(2*({0}))/2",t));break;case L:e=r.parse(f("sin({0})^2/cos({0})^2",t));break;case P:e=r.parse(f("1/2+cosh(2*({0}))/2",t));break;case D:e=r.parse(f("-1/2+cosh(2*({0}))/2",t));break;case R:e=r.parse(f("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",t));break;case N:e=r.parse(f("(1-cos(2*({0})))/(1+cos(2*({0})))+1",t));break;default:e=n}else if(this.fname===N)e=r.parse(f("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===C)e=r.parse(f("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===L)e=this.power.lessThan(0)?r.parse(f("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):r.parse(f("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===M&&this.power.lessThan(0))e=r.parse(f("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===x&&this.power.lessThan(0))e=r.parse(f("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===M&&this.power.equals(3))e=r.parse(f("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===x&&this.power.equals(3))e=r.parse(f("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if(this.fname!==x&&this.fname!==M||!c(this.power))e=n;else{var a=this.power/2,l=r.pow(this.clone().toLinear(),r.parse(2)).fnTransform(),u=r.expand(r.pow(l,r.parse(a)));e=new o(0),u.each((function(t){var i=t.fnTransform();e=r.add(e,i)}),!0)}return r.multiply(e,i)},o.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===h)return!1;if(this.fname&&(e.Utils.in_trig(this.fname)||e.Utils.in_inverse_trig(this.fname)))return!0;if(this.symbols)for(var r in this.symbols)if(this.symbols[r].hasTrig())return!0;return!1},e.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},e.Utils.toCommonDenominator=function(t){if(t.isComposite()&&t.isLinear()){var i=new o(t.multiplier),n=new o(1),a=new o(0);return t.each((function(e){n=r.multiply(n,e.getDenom())}),!0),t.each((function(e){var t=e.getNum(),i=e.getDenom(),s=r.multiply(t,r.divide(n.clone(),i));a=r.add(a,s)})),r.multiply(i,e.Algebra.divide(r.expand(a),r.expand(n)))}return t},e.Utils.in_inverse_trig=function(e){return-1!==[_,F,T,E,A,I].indexOf(e)},e.Utils.in_trig=function(e){return-1!==[x,M,L,N,C,k].indexOf(e)},e.Utils.in_htrig=function(e){return-1!==[D,P,R,j,z,B].indexOf(e)},e.Matrix.jacobian=function(r,t){var i=new e.Matrix;return t||(t=e.Utils.arrayGetVariables(r)),t.forEach((function(t,n){r.forEach((function(r,a){var s=e.Calculus.diff(r.clone(),t);i.set(a,n,s)}))})),i},e.Matrix.prototype.max=function(){var e=new o(0);return this.each((function(r){var t=r.abs();t.gt(e)&&(e=t)})),e},e.Matrix.cMatrix=function(t,i){var n=new e.Matrix;return i.forEach((function(e,i){n.set(i,0,r.parse(t))})),n};var Q=e.Utils.all_functions=function(e){for(var r=0,t=e.length;r<t;r++)if(e[r].group!==s)return!1;return!0},Z=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(f("(sin(({0})+({1}))-sin(({0})-({1})))/2",i,n))},X=e.Utils.cosAsinAtranform=function(e,t){return 1!==Number(t.power)?r.multiply(e,t):(i=e.args[0],r.parse(f("(sin(2*({0})))/2",i)));var i},Y=e.Utils.cosAsinBtranform=function(e,t){var i,n;return i=e.args[0],n=t.args[0],r.parse(f("(cos(({0})+({1}))-cos(({0})-({1})))/2",i,n))},J=e.Utils.trigTransform=function(e){for(var t,i,n={},a=new o(1),l=0,u=e.length;l<u;l++)if((t=e[l]).group===s){var p=t.fname;p===x&&n.sin?(i=n.sin.args[0].toString()!==t.args[0].toString()?Z(t,n.sin):X(t,n.sin),delete n.sin,a=r.multiply(a,i)):p===M&&n.cos?(i=n.cos.args[0].toString()!==t.args[0].toString()?Z(t,n.cos):X(t,n.cos),delete n.cos,a=r.multiply(a,i)):p===M&&n.sin?(n.sin.args[0].toString()!==t.args[0].toString()?(i=Y(t,n.sin),delete n.sin):(i=r.multiply(t,n.sin),delete n.sin),a=i):n[p]=t}else a=r.multiply(a,t);for(var f in n)a=r.multiply(a,n[f]);return a};e.Settings.integration_depth=10,e.Settings.max_lim_depth=10;var K=e.Calculus={version:"1.4.6",sum:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";n=Number(n),a=Number(a),s=e.Utils.block(u,(function(){for(var s=t.text(),l={"~":!0},u=new e.Symbol(0),p=n;p<=a;p++){l[i]=new o(p);var f=r.parse(s,l);u=r.add(u,f)}return u}))}else s=r.symfunction("sum",arguments);return s},product:function(t,i,n,a){if(i.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+l(i)+" provided");var s;if(i=i.value,e.Utils.isNumericSymbol(n)&&e.Utils.isNumericSymbol(a)){var u=a-n<200?"":"PARSE2NUMBER";s=e.Utils.block(u,(function(){n=Number(n),a=Number(a.multiplier);for(var s=t.text(),l={},u=new e.Symbol(1),p=n;p<=a;p++)l[i]=new o(p),u=r.multiply(u,r.parse(s,l));return u}))}else s=r.symfunction("product",arguments);return s},diff:function(t,p,c){if(e.Utils.isVector(t)){var m=new e.Vector([]);return t.each((function(e){m.elements.push(K.diff(e,p,c))})),m}if(e.Utils.isMatrix(t)){var D=new e.Matrix;return t.each((function(e,r,t){D.set(r,t,K.diff(e,p,c))})),D}var P=a(p)?p.text():p;if(c=a(c)?c.multiplier:c||1,void 0===P&&(P=e.Utils.variables(t)[0]),t.group===s&&t.fname===U){var H=t.args[0],Q=t.power.clone();H.group===g&&H.group===b||(H.power=a(H.power)?r.multiply(H.power,r.multiply(new o(.5)),Q):H.power.multiply(new i(.5)).multiply(Q),H.multiplier=H.multiplier.multiply(t.multiplier)),t=H}if(t.group!==s||a(t.power))t=J(t);else{var Z=J(r.parse(t)),X=K.diff(t.args[0].clone(),P);t=r.multiply(Z,X)}return c>1&&(c--,t=K.diff(t,p,c)),t;function Y(e){return(e.value===P||e.contains(P,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new i(1)),e.power.equals(0)&&(e=o(e.multiplier))),e}function J(e){var t,c,m=e.group;if(m===g||m===h&&e.value!==P||m===b)e=o(0);else if(m===h)e=Y(e);else{if(m===w){var U=e.multiplier.clone();e.toUnitMultiplier();var D=r.multiply(function(e){for(var t=e.collectSymbols(),i=new o(0),n=t.length,a=0;a<n;a++){for(var s=K.diff(t[a].clone(),P),l=0;l<n;l++)a!==l&&(s=r.multiply(s,t[l].clone()));i=r.add(i,s)}return i}(e),Y(e));return D.multiplier=D.multiplier.multiply(U),D}if(m===s&&e.power.equals(1))switch(e.fname){case S:c=e.clone(),(e=e.args[0].clone()).power=e.power.negate(),e.multiplier=c.multiplier.divide(e.multiplier);break;case x:e.fname=M,e.multiplier.negate();break;case M:e.fname=x;break;case L:e.fname=N,e.power=new i(2);break;case N:e=W(e,L);break;case C:e=W(e,"-cot");break;case k:e.fname=C,e.multiplier.negate(),e.power=new i(2);break;case _:e=r.parse("(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case F:e=r.parse("-(sqrt(1-("+l(e.args[0])+")^2))^(-1)");break;case T:e=r.parse("(1+("+l(e.args[0])+")^2)^(-1)");break;case q:U=e.multiplier.clone(),e.toUnitMultiplier(),(t=e.args[0].clone()).toUnitMultiplier(),(e=r.parse(u(l(e.args[0]))+"/abs"+u(l(t)))).multiplier=U;break;case"parens":e=o(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case R:e.fname=V,e.power=new i(2);break;case V:e=W(e,"-tanh");break;case O:var H=String(e.args[0]);return r.parse("-coth("+H+")*csch("+H+")");case G:H=String(e.args[0]);return r.parse("-csch("+H+")^2");case"asinh":e=r.parse("(sqrt(1+("+l(e.args[0])+")^2))^(-1)");break;case"acosh":e=r.parse("(sqrt(-1+("+l(e.args[0])+")^2))^(-1)");break;case"atanh":e=r.parse("(1-("+l(e.args[0])+")^2)^(-1)");break;case z:H=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+H+")^2-1)*("+H+")^2)");break;case B:e=r.parse("-1/(("+e.args[0]+")^2-1)");break;case j:H=String(e.args[0]);e=r.parse("-1/(sqrt(1/("+H+")^2+1)*("+H+")^2)");break;case A:H=String(e.args[0]);e=r.parse("1/(sqrt(1-1/("+H+")^2)*("+H+")^2)");break;case E:H=String(e.args[0]);e=r.parse("-1/(sqrt(1-1/("+H+")^2)*("+H+")^2)");break;case I:e=r.parse("-1/(("+e.args[0]+")^2+1)");break;case"S":H=String(e.args[0]);e=r.parse("sin((pi*("+H+")^2)/2)");break;case"C":H=String(e.args[0]);e=r.parse("cos((pi*("+H+")^2)/2)");break;case"Si":H=e.args[0];e=r.parse("sin("+H+")/("+H+")");break;case"Shi":H=e.args[0];e=r.parse("sinh("+H+")/("+H+")");break;case"Ci":H=e.args[0];e=r.parse("cos("+H+")/("+H+")");break;case"Chi":H=e.args[0];e=r.parse("cosh("+H+")/("+H+")");break;case"Ei":H=e.args[0];e=r.parse("e^("+H+")/("+H+")");break;case"Li":H=e.args[0];e=r.parse("1/"+n.LOG+"("+H+")");break;case"erf":e=r.parse("(2*e^(-("+e.args[0]+")^2))/sqrt(pi)");break;case"atan2":var Q=String(e.args[0]),Z=String(e.args[1]);e=r.parse("("+Z+")/(("+Z+")^2+("+Q+")^2)");break;case"sign":e=new o(0);break;case"sinc":e=r.parse(f("(({0})*cos({0})-sin({0}))*({0})^(-2)",e.args[0]));break;case n.LOG10:e=r.parse("1/(("+e.args[0]+")*"+n.LOG+"(10))");break;default:e=r.symfunction("diff",[e,p])}else if(m===y||m===s&&a(e.power)){var X;X=m===y?e.value:m===s&&e.contains(P)?e.fname+u(l(e.args[0])):e.value+u(l(e.args[0])),r.multiply(r.parse(S+u(X)),e.power.clone()),t=K.diff(r.multiply(r.parse(S+u(X)),e.power.clone()),P),e=r.multiply(e,t)}else if(m!==s||e.power.equals(1)){if(m===d||m===v){var $=e.clone(),ee=new o(0);for(var re in e.symbols)ee=r.add(ee,K.diff(e.symbols[re].clone(),P));e=r.multiply(Y($),ee)}}else(t=e.clone()).toLinear(),t.toUnitMultiplier(),e=r.multiply(Y(e.clone()),J(t))}return e.updateHash(),e}function W(e,t,i){return r.multiply(e,r.parse(t+u(i||l(e.args[0]))))}},integration:{u_substitution:function(t,i){function n(e,t,n){var a=K.diff(t,i),s=n?n(e,t):r.divide(e.clone(),a);return s.contains(i,!0)?null:s}function a(e,t){var i=K.integrate(r.symfunction(e,[new o(m)]),m,0);return(i=i.sub(new o(m),t)).updateHash(),i}var l,u=t[0].clone(),p=t[1].clone(),f=u.group,c=p.group,m="__u__";if(f===s&&c!==s){if(l=n(p,(g=u.args[0]).clone()))return r.multiply(l,a(u.fname,g));if(l=n(p,u))return K.integration.poly_integrate(u)}else if(c===s&&f!==s){var g;if(l=n(u,(g=p.args[0]).clone()))return r.multiply(l,a(p.fname,g))}else if(f===s&&c===s){if(l=n(u.clone(),p.clone()))return r.multiply(K.integration.poly_integrate(p),l);if(l=n(p.clone(),u.clone()))return r.multiply(K.integration.poly_integrate(p),l)}else{if(f===y&&c!==y){if(!(l=n(p,(q=u.power).clone()))){var h=K.integration.decompose_arg(q.clone(),i),v=K.diff(h[2].clone(),i),d=K.integration.decompose_arg(v.clone(),i);if(r.multiply(h[1],d[1]).power.equals(p.power)){var w=r.divide(h[0].clone(),d[0].clone()),b=r.multiply(w.clone(),r.pow(new o(u.value),r.multiply(h[0],new o(m))));return b=r.multiply(b,new o(m)),K.integration.by_parts(b,m,0,{}).sub(m,h[1].clone())}}var S=K.integrate(u.sub(q.clone(),new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(c===y&&f!==y){var q;l=n(u,(q=p.power).clone());S=K.integrate(p.sub(q,new o(m)),m,0);return r.multiply(S.sub(new o(m),q),l)}if(u.isComposite()||p.isComposite()){var U=function(t,n){var a=K.diff(n,i),s=e.Algebra.Factor.factor(t),o=e.Algebra.Factor.factor(a);return r.divide(s,o)},M=u.isComposite()?u.clone().toLinear():u.clone(),x=p.isComposite()?p.clone().toLinear():p.clone();if(l=n(M.clone(),x.clone(),U))return r.multiply(K.integration.poly_integrate(p),l);if(l=n(x.clone(),M.clone(),U))return r.multiply(K.integration.poly_integrate(u),l)}}},poly_integrate:function(e){var t=e.power.toString(),i=e.multiplier.toDecimal(),n=e.toUnitMultiplier().toLinear();return-1===Number(t)?r.multiply(new o(i),r.symfunction(S,[n])):r.parse(f("({0})*({1})^(({2})+1)/(({2})+1)",i,n,t))},stop:function(r){throw r=r||"Unable to compute integral!",e.Utils.warn(r),new H(r)},partial_fraction:function(t,i,n,s){var l,u;return a(i)||(i=r.parse(i)),l=new o(0),(u=e.Algebra.PartFrac.partfrac(t,i)).group===w&&u.isLinear()?(u.each((function(e){e.isLinear()||K.integration.stop()})),u.each((function(e){l=r.add(l,K.integrate(e,i,n,s))}))):l=r.add(l,K.integrate(u,i,n,s)),l},get_udv:function(t){var i=[[],[],[],[],[]],n=function(r){var t=r.group;if(t===s){var n=r.fname;e.Utils.in_trig(n)||e.Utils.in_htrig(n)?i[3].push(r):e.Utils.in_inverse_trig(n)?i[1].push(r):n===S?i[0].push(r):K.integration.stop()}else t===h||r.isComposite()&&r.isLinear()||t===w&&r.isLinear()?i[2].push(r):t===y||r.isComposite()&&!r.isLinear()?i[4].push(r):K.integration.stop()};t.group===w?t.each((function(e){n(o.unwrapSQRT(e,!0))})):n(t);for(var a,l=new o(1),u=0;u<5;u++){var p,f=i[u],c=f.length;if(c>0){if(c>1){p=new o(1);for(var m=0;m<c;m++)p=r.multiply(p,f[m].clone())}else p=f[0].clone();a?l=r.multiply(l,p):(a=p).multiplier=a.multiplier.multiply(t.multiplier)}}return[a,l]},trig_sub:function(t,i,n,a,s,o){(s=s||K.integration.decompose_arg(t.clone().toLinear(),i))[3],s[2];var l=s[0],p=s[1];if(p.power.equals(2)&&l.greaterThan(0)){var f=e.Utils.getU(t),c=r.parse(L+u(f)),m=r.parse(N+u(f)+"^2"),g=r.multiply(t.sub(p,c),m),h=K.integrate(g,f,n,a).sub(c,p);return e.Utils.clearU(c),h}},by_parts:function(t,i,n,a){var s,l,u,p,f,c,m,g,h,v,d,w;if(a.previous=a.previous||[],l=(s=K.integration.get_udv(t))[0],u=s[1],d=(p=o.unwrapSQRT(r.expand(K.diff(l.clone(),i)),!0)).clone().stripVar(i),p=r.divide(p,d.clone()),f=K.integrate(u.clone(),i,n||0),w=(c=r.multiply(f.clone(),p)).toString(),-1!==a.previous.indexOf(w)&&e.Utils.in_trig(l.fname)&&u.isE())return a.is_cyclic=!0,new o(1);if(a.previous.push(w),m=r.multiply(l,f),v=c.multiplier.clone(),c.toUnitMultiplier(),(h=r.multiply(K.integrate(c.clone(),i,n,a),d)).multiplier=h.multiplier.multiply(v),g=r.subtract(m,h),a.is_cyclic&&(a.previous.pop(),0===a.previous.length)){g=r.expand(g);var y=new o(0);g.each((function(e){e.contains(i)||(y=r.add(y,e.clone()))})),g=r.divide(r.subtract(g,y.clone()),r.subtract(new o(1),y))}return g},decompose_arg:e.Utils.decompose_fn},integrate:function(t,l,m,g){if(!l){var b=e.Utils.variables(t);1===b.length&&(l=b[0]),l=l||"x"}if(e.Utils.isVector(t)){var Z=new e.Vector([]);return t.each((function(e){Z.elements.push(K.integrate(e,l))})),Z}return isNaN(l)||r.error("variable expected but received "+l),t.isConstant(!0)?r.multiply(t.clone(),r.parse(l)):(g=g||{},e.Utils.block("PARSE2NUMBER",(function(){m=m||0;var b,Z=a(l)?l.toString():l,X=o.unwrapSQRT(t.clone(),!0),Y=X.group;try{if(++m>e.Settings.integration_depth&&K.integration.stop("Maximum depth reached. Exiting!"),X.contains(Z,!0)){if(Y===h)b=K.integration.poly_integrate(X,Z,m);else if(Y===y)if(X.previousGroup===s&&"sqrt"!==X.fname&&X.fname!==n.PARENTHESIS&&K.integration.stop(),X.contains(Z)&&X.previousGroup!==s){if(X.power.contains(Z))K.integration.stop();else(Ye=K.diff(X.clone().toLinear(),Z)).contains(Z)&&K.integration.stop(),b=K.integration.poly_integrate(X,Z,m)}else{if((ae=K.diff(X.power.clone(),Z)).contains(Z)){var W=ae.stripVar(Z);if((se=r.divide(ae.clone(),W.clone())).group===h&&se.isLinear())return W.multiplier=W.multiplier.divide(new i(2)),r.parse(f("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",W,Z,X.multiplier));K.integration.stop()}if(X.isE())ae.isLinear()?b=X:ae.isE()&&ae.power.group===h&&ae.power.power.equals(1)?b=r.multiply(r.symfunction("Ei",[X.power.clone()]),X.power):K.integration.stop();else{var $=r.symfunction(S,[r.parse(X.value)]);b=r.divide(X,$)}b=r.divide(b,ae)}else if(X.isComposite()&&X.isLinear()){var ee=r.parse(X.multiplier);X.toUnitMultiplier(),b=new o(0),X.each((function(e){b=r.add(b,K.integrate(e,Z,m))})),b=r.multiply(ee,b)}else if(Y===d)if(X.power.greaterThan(1)&&(X=r.expand(X)),X.power.equals(1))b=new o(0),X.each((function(e){b=r.add(b,K.integrate(e,Z,m))}),!0);else{var re=Number(X.power);ee=X.multiplier.clone();X.toUnitMultiplier();var te=X.clone().toLinear(),ie=(Er=K.integration.decompose_arg(te,Z))[3],ne=Er[2],ae=Er[0],se=Er[1];if(-1===re&&se.group!==v&&se.power.equals(2)){var oe=!p(ie)||ie>0;if(se.group===h&&se.power.equals(2)&&oe){var le=function(e){var t=new o(1);return e.each((function(e){t=r.multiply(t,"abs"===e.fname?e.args[0]:e)})),t},ue=ae.clone(),pe=ie.clone();ue=r.pow(ue,new o(.5)),pe=r.pow(pe,new o(.5));$=r.multiply(le(pe),le(ue));var fe=r.symfunction(T,[r.divide(r.multiply(ae,se.toLinear()),$.clone())]);b=r.divide(fe,$)}else if(se.group===h&&se.isLinear())b=r.divide(K.integration.poly_integrate(X),ae);else if(se.power.equals(4)){var ce,me,ge,he,ve,de,we=u;ue=r.parse(U+we(ae)+"*"+Z+"^2"),pe=r.parse(U+we(2)+"*"+we(ae)+"^"+we("1/4")+"*"+we(ie)+"^"+we("1/4")+"*"+Z),ce=r.parse(U+we(ie)),Fe=r.add(r.add(ue.clone(),pe.clone()),ce.clone()),er=r.add(r.subtract(ue,pe),ce),me=r.parse(U+we(2)+"*"+we(ie)+"^"+we("3/4")),ge=r.parse(U+we(ie)+"*"+we(ie)+"^"+we("1/4")+"*"+Z),he=r.parse("2*"+we(ie)+"*"+U+we(2)+"*"+we(ie)+"^"+we("1/4")),ve=r.divide(r.subtract(me.clone(),ge.clone()),r.multiply(he.clone(),er)),de=r.divide(r.add(me,ge),r.multiply(he,Fe.clone())),b=r.add(K.integrate(ve,Z,m,g),K.integrate(de,Z,m,g))}else b=K.integration.partial_fraction(X,Z,m)}else if(-.5===re)if(se.group===h&&se.power.equals(2))if(ne.multiplier.lessThan(0)&&!ie.multiplier.lessThan(0))if(ae.negate(),ie.isConstant()&&ae.isConstant()){$=r.symfunction(U,[ae.clone()]);var ye=r.symfunction(U,[r.multiply(ae.clone(),ie)]);b=r.divide(r.symfunction(_,[r.divide(ne.toLinear(),ye)]),$)}else{var be=r.symfunction(U,[ae]),Se=r.multiply(be.clone(),se.clone().toLinear());b=r.divide(r.symfunction(T,[r.divide(Se,r.symfunction(U,[te.clone()]))]),be)}else K.integration.stop();else K.integration.stop();else if(se.isLinear()&&se.group!==v)b=r.divide(K.integration.poly_integrate(X),ae);else{if(se.power.equals(2)&&ae.greaterThan(0)){var qe,Ue,Me,xe,Le,Ne;qe=r.parse(U+u(ae)),Ue=r.parse(U+u(ie)),Me=r.multiply(qe.clone(),Ue.clone()).invert(),xe=r.pow(ie,new o(X.power)),Ne=e.Utils.getU(X),De=r.multiply(Me,se.clone().toLinear()),Le=r.parse(T+u(De));var Ce=2*(Math.abs(X.power)-1),ke=K.integrate(r.parse(x+u(Ne)+"^"+Ce));return e.Utils.clearU(Ne),r.multiply(ke.sub(Ne,Le),xe)}if(X.group===w||X.power.lessThan(0)){fe=X.clone().toLinear();var _e=e.Algebra.Factor.factor(fe).toString()!==fe.toString();if(e.Algebra.degree(fe,r.parse(Z)).equals(2)&&!_e)try{var Fe,Te,Ae;Ae=e.Algebra.sqComplete(fe,Z),De=e.Utils.getU(fe),Fe=Ae.f.sub(Ae.a,De),Te=r.pow(Fe,r.parse(X.power)),b=K.integrate(Te,De).sub(De,Ae.a)}catch(et){K.integration.stop()}else b=K.integration.partial_fraction(X,Z,m,g)}else b=K.integration.by_parts(X,Z,m,g)}b.multiplier=b.multiplier.multiply(ee)}else if(Y===s){var Ee=X.args[0];ee=X.multiplier.clone();X.toUnitMultiplier();ae=(Er=K.integration.decompose_arg(Ee,Z))[0],se=Er[1];var Ie=X.fname;if(Ie===S||Ie===_||Ie===F||Ie===T&&se.isLinear()){re=X.power.toString();if(p(re)&&(m-=re),Ee.isComposite()){var De=e.Utils.getU(X),Pe=(fe=r.pow(r.parse(S+u(De)),new o(re)),K.diff(Ee,Z)),Re=r.multiply(fe,Pe);ke=K.integrate(Re,De,m,g);b=r.multiply(r.parse(ee),ke.sub(De,Ee))}else b=r.multiply(r.parse(ee),K.integration.by_parts(X,Z,m,g))}else{if(Ie===L&&X.power.lessThan(0))return(Hr=X.clone()).power.negate(),Hr.fname=k,r.multiply(r.parse(ee),K.integrate(Hr,Z,m));if(!ae.contains(Z,!0)&&X.isLinear())if(Ie===q){if((se=r.divide(Ee.clone(),ae.clone())).group!==h||se.power.lessThan(0))K.integration.stop();else if(e.Utils.even(se.power))b=K.integrate(Ee,Z,m);else{var Oe=K.integrate(se,Z,m);Oe.power=Oe.power.subtract(new i(1)),b=r.multiply(r.multiply(r.symfunction(q,[se.toLinear()]),Oe),ae)}}else{var Ve=X.args[0].group,Ge=K.integration.decompose_arg(Ee,Z);switch((Ve!==d&&Ve!==h&&Ve!==w||!Ge[1].power.equals(1)||Ee.hasFunc())&&K.integration.stop(),Ie){case x:b=r.symfunction(M,[Ee]);break;case M:(b=r.symfunction(x,[Ee])).negate();break;case L:b=r.parse(f(n.LOG+"(sec({0}))",Ee));break;case N:b=r.parse(f(n.LOG+"(tan({0})+sec({0}))",Ee));break;case C:b=r.parse(f("-"+n.LOG+"(csc({0})+cot({0}))",Ee));break;case k:b=r.parse(f(n.LOG+"(sin({0}))",Ee));break;case D:b=r.symfunction(P,[Ee]);break;case P:b=r.symfunction(D,[Ee]);break;case R:b=r.parse(f(n.LOG+"(cosh({0}))",Ee));break;case A:case E:case I:case z:case j:case B:b=K.integration.by_parts(X,Z,m,g);break;case V:b=r.parse(f("atan(sinh({0}))",Ee));break;case O:b=r.parse(f(n.LOG+"(tanh(({0})/2))",Ee));break;case G:b=r.parse(f(n.LOG+"(sinh({0}))",Ee));break;case"exp":b=K.integrate(r.parse(f("e^({0})",Ee)),Z,m);break;case"S":Ee=X.args[0].clone();var ze=(Vr=K.integration.decompose_arg(Ee,Z))[1],je=Vr[0],Be=Vr[3];b=r.parse(f("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",je,Be,se));break;case"C":Ee=X.args[0].clone(),ze=(Vr=K.integration.decompose_arg(Ee,Z))[1],je=Vr[0],Be=Vr[3];b=r.parse(f("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",je,Be,ze));break;case"erf":Ee=X.args[0].clone(),ze=(Vr=K.integration.decompose_arg(Ee,Z))[1],je=Vr[0];b=r.parse(f("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",je,ze,Ee));break;case"sign":b=r.multiply(X.clone(),Ee.clone());break;default:K.integration.stop()}b=r.divide(b,ae)}else if(se.isLinear()){if(Ie===x||Ie===M)if((re=Number(X.power))<0)X.fname=Ie===M?C:N,X.invert().updateHash(),b=K.integrate(X,Z,m);else{Ee=X.args[0];var He=X.clone(),Qe=X.clone(),Ze=new o((re-1)/re),Xe=r.multiply(ae.clone(),new o(re)).invert();He.power=He.power.subtract(new i(1)),Qe.power=Qe.power.subtract(new i(2));var Ye=r.symfunction(Ie===x?M:x,[Ee.clone()]);Ie===M&&Ye.negate(),b=r.add(r.multiply(r.multiply(Xe,He),Ye),r.multiply(Ze,K.integrate(r.parse(Qe),Z,m)))}else if(Ie===L||Ie===k){if(X.args[0].isLinear(Z)){Ce=X.power.subtract(new i(1)).toString();var Je=X.clone().toUnitMultiplier(),Ke=r.parse(f((Ie===k?"-":"")+"1/({2}*{0})*{3}({1})^({0})",Ce,Ee,ae,Ie));Je.power=Je.power.subtract(new i(2)),Je.power.equals(0)&&(Je=r.parse(Je)),b=r.subtract(Ke,K.integrate(Je,Z,m))}}else if(Ie===N||Ie===C){var We=X.power.subtract(new i(1)).toString(),$e=X.power.subtract(new i(2)).toString(),er=Ie===N?L:k,rr=(Je=X.clone().toUnitMultiplier(),f((Ie===C?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",ae,We,$e,Ee,Ie,er));Ke=r.parse(rr);Je.power=Je.power.subtract(new i(2)),Je.power.equals(0)&&(Je=r.parse(Je)),b=r.add(Ke,r.multiply(new o($e/We),K.integrate(Je,Z,m)))}else Ie!==P&&Ie!==D||!X.power.equals(2)?K.integration.stop():b=K.integrate(X.fnTransform(),Z,m)}else K.integration.stop();b.multiplier=b.multiplier.multiply(ee)}}else if(Y===v)b=K.integration.partial_fraction(X,Z,m);else if(Y===w){X.getDenom().group===h&&(X=r.expand(X));var tr=X.stripVar(Z),ir=r.divide(X.clone(),tr.clone());if(tr.contains(Z)&&(ir=r.multiply(ir,tr),tr=new o(1)),ir.group!==w){if(ir.equals(1))return K.integrate(r.expand(X),Z,m);ir.clone().toLinear().isPoly(!0)&&e.Utils.variables(ir).length>1&&(ir=e.Algebra.Factor.factor(ir)),b=K.integrate(ir,Z,m)}else{var nr=ir.collectSymbols().sort((function(e,r){return e.group===r.group?Number(e.power)===Number(r.power)?e<r?1:-1:r.power-e.power:r.group-e.group})).map((function(e){var t=o.unwrapSQRT(e,!0);return"exp"===t.fname?r.parse(f("({1})*e^({0})",t.args[0],t.multiplier)):t})),ar=nr.length;if(X.power<0){if(2===ar)return K.integrate(r.expand(X),Z,m,g)}else if(2===ar){try{b=K.integration.u_substitution(nr,Z)}catch(et){}if(!b){var sr=nr[0].group,or=nr[1].group,lr=nr[0],ur=nr[1],pr=lr.fname,fr=ur.fname;if(X=r.multiply(lr.clone(),ur.clone()),sr===s&&or===s)if(pr===S||fr===S)b=K.integration.by_parts(X.clone(),Z,m,g);else{nr.sort((function(e,r){return r.fname>e.fname}));var cr=lr.args[0];(!cr.isLinear()||cr.group!==d&&cr.group!==w&&cr.group!==h)&&K.integration.stop(),se=(Er=K.integration.decompose_arg(cr,Z))[1],ae=Er[0],se.isLinear()||K.integration.stop();var mr=ur.args[0];if(cr.equals(mr))if(pr===M&&fr===x||pr===x&&fr===M)if(lr.power.lessThan(0)&&K.integration.stop(),pr===M&&lr.power.add(ur.power).equals(0))lr.fname=L,lr.updateHash(),b=K.integrate(lr,Z,m);else if(c(lr.power)&&fr===x&&ur.power.lessThan(0)){Ce=Number(lr.power)/2;var gr=r.parse(f("(1-cos({0})^2)^({1})",lr.args[0],Ce));b=K.integrate(r.expand(r.multiply(gr,ur.clone())),Z,m,g)}else if(c(lr.power)&&fr===M&&ur.power.lessThan(0)){Ce=Number(lr.power)/2,gr=r.parse(f("(1-sin({0})^2)^({1})",lr.args[0],Ce));b=K.integrate(r.expand(r.multiply(gr,ur.clone())),Z,m,g)}else{var hr=e.Utils.even(lr.power),vr=e.Utils.even(ur.power);if(b=new o(0),hr&&vr){var dr=function(e){var t,i=e.power/2;return t=e.fname===x?"((1/2)+(cos(2*("+e.args[0]+"))/2))^"+i:"((1/2)-(cos(2*("+e.args[0]+"))/2))^"+i,r.parse(t)};ae=dr(lr),ie=dr(ur),Ye=r.multiply(ae,ie);return(Hr=r.expand(Ye)).each((function(e){b=r.add(b,K.integrate(e,Z,m))})),r.multiply(b,tr)}hr?(De=lr,Je=ur):(De=ur,Je=lr);var wr=De.fname===x?-1:1,yr=((Ce=Je.power)-1)/2,br=r.parse("(1-"+De.fname+e.Utils.inBrackets(cr)+"^2)^"+yr);(Hr=r.expand(r.multiply(new o(wr),r.multiply(De.clone(),br)))).each((function(e){b=r.add(b,K.integration.poly_integrate(e.clone()))}))}else if(pr===N&&fr===L&&se.isLinear()&&ur.isLinear())b=r.parse(f("sec({0})^({1})/({1})",lr.args[0],lr.power));else if(pr===L&&fr===N&&se.isLinear())if(lr.isLinear()&&ur.isLinear())b=r.divide(r.symfunction(N,[cr.clone()]),ae);else if(c(lr.power)){re=Number(lr.power)/2,Ye=r.parse(f("(sec({0})^2-1)^({1})",lr.args[0],re));b=K.integrate(r.expand(r.multiply(Ye,ur)),Z,m)}else K.integration.stop();else if(pr===N&&fr===x)lr.fname=x,lr.invert().updateHash(),b=K.integrate(r.multiply(lr,ur),Z,m);else if(pr===M&&fr===C)ur.fname=M,ur.invert().updateHash(),b=K.integrate(r.multiply(lr,ur),Z,m);else if(pr!==L||fr!==x&&fr!==M||!ur.power.lessThan(0)){Ye=r.multiply(lr.fnTransform(),ur.fnTransform());b=K.integrate(r.expand(Ye),Z,m)}else{var Ye=r.multiply(lr.fnTransform(),ur);b=K.integrate(r.expand(Ye),Z,m)}else if(pr!==M&&pr!==x||fr!==M&&fr!==x)K.integration.stop();else if(lr.isLinear()&&ur.isLinear())if(lr.args[0].isLinear()&&ur.args[0].isLinear()){fr===M?(ne=lr.args[0],Gr=ur.args[0]):(Gr=lr.args[0],ne=ur.args[0]),fe=r.parse(f("(sin(({1})+({0}))+sin(({1})-({0})))/2",ne.toString(),Gr.toString())),b=K.integrate(fe,Z,m)}else{var Sr=J(nr);b=K.integrate(r.expand(Sr),Z,m)}else{Sr=new o(1);nr.map((function(e){var t=e.fnTransform();Sr=r.multiply(Sr,t)}));Ye=r.expand(Sr);(b=K.integrate(Ye,Z,m)).hasIntegral()&&(b=K.integrate(J(Sr.collectSymbols()),Z,m))}}else if(sr===s&&or===h){var qr=lr.isLinear();if(lr.fname===x&&qr&&ur.power.equals(-1))b=r.symfunction("Ci",[lr.args[0]]);else if(lr.fname===x&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===P&&qr&&ur.power.equals(-1))b=r.symfunction("Chi",[lr.args[0]]);else if(lr.fname===P&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===M&&qr&&ur.power.equals(-1))b=r.symfunction("Si",[lr.args[0]]);else if(lr.fname===M&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===D&&qr&&ur.power.equals(-1))b=r.symfunction("Shi",[lr.args[0]]);else if(lr.fname===D&&ur.power.equals(-1))b=K.integrate(r.multiply(lr.fnTransform(),ur.clone()),Z,m);else if(lr.fname===S&&ur.power.equals(-1))b=K.integration.poly_integrate(lr,Z,m);else if("erf"===lr.fname){if(ur.power.equals(1)){je=(Vr=K.integration.decompose_arg(lr.args[0],Z))[0],ze=Vr[1],Ee=lr.args[0].toString();b=r.parse(f("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",je,ze,Ee))}}else b=K.integration.by_parts(X,Z,m,g)}else if(sr===y&&or===h){se=pr===S?K.integration.decompose_arg(lr.args[0],Z)[1]:null;b=lr.isE()&&(lr.power.group===h||lr.power.group===w)&&ur.power.equals(-1)?r.symfunction("Ei",[lr.power.clone()]):pr===S&&se.value===ur.value?K.integration.poly_integrate(lr,Z,m):K.integration.by_parts(X,Z,m,g)}else if(sr===v&&or===h){if(ur.value===lr.value&&lr.power.equals(-1)){var Ur=Math.min.apply(null,e.Utils.keys(lr.symbols)),Mr=Math.min(Ur,ur.power),xr=ur.clone();xr.power=new i(Mr),ur=r.divide(ur,xr.clone());Ye=new o(0);lr.each((function(e){Ye=r.add(Ye,r.divide(e.clone(),xr.clone()))})),Ye.multiplier=lr.multiplier,X=r.divide(ur,Ye)}else X=r.expand(X);b=K.integration.partial_fraction(X,Z,m)}else if(sr===d&&or===h){fe=lr.clone().toLinear();var Lr=e.Algebra.degree(fe,r.parse(Z)).equals(1);if(lr.power.equals(-.5)){ae=(Er=K.integration.decompose_arg(lr.clone().toLinear(),Z))[0].negate(),se=Er[1],ie=Er[3];var Nr=Number(lr.power),Cr=Number(ur.power);if(p(Cr)&&e.Utils.even(Cr)&&se.power.equals(2)){var kr=r.divide(r.multiply(r.pow(ie.clone(),new o(2)),r.symfunction(U,[r.divide(ie.clone(),ae.clone())])),r.pow(ae.clone(),new o(2)));kr=r.multiply(kr,r.symfunction(U,[ie]).invert());var _r=r.parse("sin(u)");_r.power=_r.power.multiply(ur.power);ke=K.integrate(_r,"u",m);var Fr=r.parse("asin(sqrt("+ae+"/"+ie+")*"+Z+")");b=r.multiply(kr,ke.sub(new o("u"),Fr))}else if(-.5===Nr){var Tr=function(e,t){var i=r.parse(K.integrate(e,Z,m,g).sub(Z,f(t,Z)));if(!i.hasIntegral())return i};-1===Cr?b=Tr(r.expand(r.expand(r.pow(r.multiply(lr.invert(),ur.invert()),new o(2)))).invert(),"sqrt(1-1/({0})^2)"):-2===Cr&&(b=Tr(r.sqrt(r.expand(r.divide(r.pow(X,new o(2)).invert(),r.pow(new o(Z),new o(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(lr.power.equals(-1)&&ur.isLinear()&&Lr)b=K.integration.partial_fraction(X,Z,m);else if(!lr.power.lessThan(0)&&p(lr.power)){var Ar=r.expand(lr);b=new o(0),Ar.each((function(e){e.group===v?e.each((function(e){b=r.add(b,K.integrate(r.multiply(ur.clone(),e),Z,m))})):b=r.add(b,K.integrate(r.multiply(ur.clone(),e),Z,m))}))}else if(lr.power.lessThan(-2))b=K.integration.by_parts(X,Z,m,g);else if(lr.power.lessThan(0)&&ur.power.greaterThan(1)){var Er;ae=(Er=K.integration.decompose_arg(lr.clone().toLinear(),Z))[0].negate(),se=Er[1],ie=Er[3],te=lr.clone().toLinear();if(se.group!==v&&se.isLinear()){re=Number(ur.power),De=new o(Pe="_u_");var Ir=r.expand(r.divide(r.pow(r.subtract(De.clone(),ie.clone()),new o(re)),De.clone())),Dr={};Dr[Pe]=te;var Pr=r.parse(Ir,Dr);b=K.integrate(Pr,Z,0)}else if(ur.power.greaterThan(se.power)||ur.power.equals(se.power)){var Rr=new e.Algebra.Classes.Factors;lr=e.Algebra.Factor.coeffFactor(lr.invert(),Rr);var Or=e.Algebra.divide(ur,lr);Or.group!==w?(b=new o(0),Or.each((function(e){b=r.add(b,K.integrate(e,Z,m))})),Rr.each((function(e){b=r.divide(b,e)})),b=r.expand(b)):b=K.integration.by_parts(X,Z,m,g)}else b=K.integration.partial_fraction(X,Z,m)}else if(lr.power.den.equals(2)){ae=(Vr=K.integration.decompose_arg(lr.clone().toLinear(),Z))[3],se=Vr[1],ie=Vr[0];var Vr,Gr=Vr[2];if(se.power.equals(2)&&ie.lessThan(0)){ae.equals(1)||(tr=r.multiply(tr,r.pow(ae,new o(2))));De=Z,kr=r.divide(r.pow(ie.clone().negate(),new o(.5)),r.pow(ae,new o(.5))),Pe=r.symfunction(x,[new o(De)]);var zr=r.pow(r.symfunction(x,[new o(De)]),new o(lr.power.num)),jr=r.pow(r.symfunction(M,[new o(De)]),new o(ur.power)),Br=r.multiply(r.multiply(zr,Pe),jr);ke=K.integrate(Br,De,m);b=ke.sub(De,r.symfunction(_,[r.multiply(new o(Z),kr)]))}else b=K.integration.partial_fraction(X,Z,m,g)}else Lr&&(b=K.integration.partial_fraction(X,Z,m))}else if(lr.isComposite()&&ur.isComposite())if(b=new o(0),lr.power.greaterThan(0)&&ur.power.greaterThan(0)){var Hr;(Hr=r.expand(X)).each((function(e){b=r.add(b,K.integrate(e,Z,m))}),!0)}else{Nr=Number(lr.power),Cr=Number(ur.power);if(Nr<0&&Cr>0){Ye=lr;lr=ur,ur=Ye}-1===Nr&&-1===Cr?b=K.integration.partial_fraction(X,Z):lr.each((function(e){var t=r.multiply(e,ur.clone()),i=K.integrate(t,Z,m);b=r.add(b,i)}))}else if(sr===d&&nr[0].power.greaterThan(0))lr=r.expand(lr),b=new o(0),lr.each((function(e){b=r.add(b,K.integrate(r.multiply(e,ur.clone()),Z,m))}),!0);else if(sr===s&&or===y&&e.Utils.in_htrig(lr.fname))lr=lr.fnTransform(),b=K.integrate(r.expand(r.multiply(lr,ur)),Z,m);else if(sr===s&&or===d||or===s&&sr===d){if(or===s&&sr===d){Ye=lr;lr=ur,ur=Ye}var Qr,Zr,Xr;if(Pe=o.unwrapSQRT(K.diff(lr.clone(),Z),!0),Qr=o.unwrapSQRT(ur,!0),Pe.power.equals(Qr.power)){if(re=new o(ur.power),Zr=Pe.clone().toLinear(),Xr=ur.clone().toLinear(),(Ze=e.Algebra.divide(Zr.toLinear(),Xr)).isConstant()){var Yr=r.pow(Ze,re.negate());b=r.multiply(Yr,K.integration.poly_integrate(lr.clone()))}}else b=K.integration.by_parts(X,Z,m,g)}else{var Jr=lr.clone().toLinear(),Kr=ur.clone().toLinear();b=sr===y&&or===y&&lr.power.contains(Z)&&ur.power.contains(Z)&&!Jr.contains(Z)&&!Kr.contains(Z)?r.parse(f("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Jr.toString(),Kr.toString(),lr.power.multiplier.toString(),ur.power.multiplier.toString(),Z)):K.integration.by_parts(X,Z,m,g)}}}else if(3===ar&&(nr[2].group===h&&nr[2].power.lessThan(2)||nr[0].group===d)){var Wr=nr[0];if(Wr.group===d){Wr.power.greaterThan(1)&&(Wr=r.expand(Wr));Je=r.multiply(nr[1],nr[2]);b=new o(0),Wr.each((function(e){var t=r.multiply(e,Je.clone()),i=K.integrate(t,Z,m);b=r.add(b,i)}),!0)}else b=K.integration.by_parts(X,Z,m,g)}else if(Q(nr)){Ye=new o(1);var $r=0;for(ar=nr.length;$r<ar;$r++)Ye=r.multiply(Ye,nr[$r].fnTransform());Ye=r.expand(Ye),b=K.integrate(Ye,Z,m)}else{Sr=J(nr);b=K.integrate(r.expand(Sr),Z,m)}}b=r.multiply(b,tr)}}else b=r.multiply(X.clone(),r.parse(Z));if(b)return b}catch(rt){if(!(rt instanceof H||rt instanceof e.exceptions.DivisionByZero))throw rt}return r.symfunction("integrate",[t,l])}),!1))},defint:function(t,i,n,a){a=a||"x";var s,l,u=function(e,t,i){try{return r.parse(e,t)}catch(n){return K.Limit.limit(e,a,i)}},p=e.Utils.variables(t),f=t.hasTrig();if(1!==p.length||a||(a=p[0]),f||(l=K.integrate(t,a)),f||l.hasIntegral())if(1===p.length&&i.isConstant()&&n.isConstant()){var c=e.Utils.build(t);s=new o(e.Math2.num_integrate(c,Number(i),Number(n)))}else s=r.symfunction("defint",[t,i,n,a]);else{var m,g,h={},v={};h[a]=n,v[a]=i,m=u(l,h,n),g=u(l,v,i),s=r.subtract(m,g)}return s},Limit:{interval:function(e,t){return r.parse(f("[{0}, {1}]",e,t))},diverges:function(){return K.Limit.interval("-Infinity","Infinity")},divide:function(t,i,a,s,l){if(!(l++>n.max_lim_depth)){t.clone();var u=i.clone();if(i.fname===q){var p=t.sign(),f=s.sign();if(s.isInfinity)return r.multiply(new o(p),new o(f));if(s.equals(0)){var c=r.parse(t.multiplier),g=r.parse(i.multiplier);return r.divide(r.multiply(c,K.Limit.interval("-1","1")),g)}K.Limit.diverges()}var h=function(r){if(e.Utils.isVector(r)){for(var t=0;t<r.elements.length;t++)if(!r.elements[t].isInfinity)return!1;return!0}return r.isInfinity},v=function(r,t){return!e.Utils.isVector(r)&&r.equals(t)};do{var d=m(K.Limit.limit(t.clone(),a,s,l)),w=m(K.Limit.limit(i.clone(),a,s,l)),y=h(d)&&h(w)||v(d,0)&&v(w,0);if(y){var b=K.diff(t.clone(),a),S=K.diff(i.clone(),a),U=r.expand(r.divide(b,S));t=U.getNum(),i=U.getDenom()}}while(y);var M=w.equals(0),x=Number(u.power);return s.isConstant(!0)&&M?o.infinity(e.Utils.even(x)&&d.lessThan(0)?-1:void 0):M?K.Limit.diverges():r.divide(d,w)}},rewriteToLog:function(e){var t=e.power.clone();return e.toLinear(),r.pow(new o("e"),r.multiply(t,r.symfunction(n.LOG+"",[e])))},getSubbed:function(e,r,t){var i;e.group===y&&(e=K.rewriteToLog(e));try{i=e.sub(r,t)}catch(n){i=e}return i},isInterval:function(r){return e.Utils.isVector(r)},isConvergent:function(e){return!(K.Limit.isInterval(e)&&e.elements[0].isInfinity&&e.elements[1].isInfinity||e.containsFunction("limit"))},limit:function(t,i,a,l){if(t.isLinear()&&t.isComposite()){var u=new o(0);return t.each((function(e){u=r.add(u,K.Limit.limit(e,i,a,l))}),!0),u}if(t=e.Algebra.Simplify.simplify(t),l=l||1,!(l++>n.max_lim_depth)){var p=r.parse(t.multiplier);t.toUnitMultiplier();try{var c;if(t.isConstant(!0))c=t;else{var g={};g[i]=a;try{var v=r.parse(t.sub(i,a),g);(v.isConstant(!0)||v.isInfinity)&&(c=v)}catch(W){}if(!c){var d=t.getNum(),b=t.getDenom();if(b.isConstant(!0)){if(t.group===y){var q=t.clone().toLinear(),U=(t.power.clone(),q.getNum()),N=q.getDenom(),C=e.Utils.decompose_fn(N,i,!0);if(U.group===h&&U.multiplier.isOne()&&C.ax.group===h&&C.b.isConstant(!0)&&C.a.isOne()&&C.b.isConstant(!0))c=r.parse(f("(1/e^({0}))",C.b));else{var k=K.Limit.rewriteToLog(t.clone()),_=k.power.clone(),F=k.clone().toLinear(),T=K.Limit.limit(F,i,a,l),A=K.Limit.limit(_,i,a,l);c=r.pow(T,A)}}else if(t.group===s&&1===t.args.length){var E,I=K.Limit.limit(t.args[0],i,a,l);if(e.Utils.isVector(I))return c=I.map((function(e){return t.clone().args[0]=e,K.Limit.limit(r.symfunction(t.fname,[e]),i,a,l)})),r.multiply(p,c);if(I.isConstant(!0)){var D=r.symfunction(t.fname,[I]);try{m(D),E=!0}catch(W){E=!1}}if(E)c=D;else if(K.Limit.isConvergent(I))if(t.fname===S)switch(I.toString()){case"0":c=o.infinity().negate();break;case"Infinity":case"-Infinity":c=o.infinity()}else if(t.fname!==x&&t.fname!==M||!a.isInfinity){if(t.fname===L){var P=t.args[0],R=P.getNum(),O=P.getDenom(),V=R.toUnitMultiplier();(a.isInfinity||V.equals("pi")&&O.equals(2))&&(c=divergent())}else if(t.fname===n.FACTORIAL&&I.isInfinity)return o.infinity()}else c=K.Limit.interval(-1,1)}else if(t.group===h){if(t.power>0)return r.parse(t,g);c=e.Utils.even(t.power)?o.infinity():K.Limit.diverges()}else if(t.group===w){var G,z;q=(H=t.collectSymbols().sort((function(e,r){return e.group-r.group}))).pop();for(G=m(K.Limit.limit(q,i,a,l));H.length;){var j=H.pop();z=m(K.Limit.limit(j,i,a,l)),G.isInfinity||!K.Limit.isConvergent(G)&&z.equals(0)||G.equals(0)&&K.Limit.isConvergent(z)?(j.containsFunction(S)&&(j=[q,q=j][0]),j.invert(),G=G.isInfinity&&z.isInfinity?o.infinity():K.Limit.divide(q,j,i,a,l)):(G=r.multiply(G,z),q=r.multiply(q,j))}c=G}else if(t.isComposite()){var B;t.isLinear()||(t=r.expand(t)),c=new o(0);for(var H=t.collectSymbols().sort((function(e,r){return r.group-e.group})),Q=[],Z=new o(0),X=0,Y=H.length;X<Y;X++){(J=H[X].clone()).group===s||J.group===w&&J.hasFunc()?Z=r.add(Z,J):Q.push(J)}Q.unshift(Z),1!==Q.length&&(H=Q);for(X=0,Y=H.length;X<Y;X++){var J=H[X];try{B=K.Limit.limit(J,i,a,l)}catch(W){B=K.Limit.diverges()}try{c=r.add(c,B)}catch(W){if(l++>n.max_lim_depth)return;c=K.Limit.limit(K.diff(t,i),i,a,l)}}}}else c=K.Limit.divide(d,b,i,a,l)}}c||(c=r.symfunction("limit",[t,i,a]))}catch(W){c=r.symfunction("limit",[t,i,a])}return r.multiply(p,c)}}},Fresnel:{S:function(e){return e.isConstant(!0)?K.defint(r.parse("sin(pi*x^2/2)"),o(0),e,"x"):r.symfunction("S",arguments)},C:function(e){return e.isConstant(!0)?K.defint(r.parse("cos(pi*x^2/2)"),o(0),e,"x"):r.symfunction("C",arguments)}}};t.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return K.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return K.sum}},{name:"product",visible:!0,numargs:4,build:function(){return K.product}},{name:"integrate",visible:!0,numargs:[1,2],build:function(){return K.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return K.defint}},{name:"S",visible:!0,numargs:1,build:function(){return K.Fresnel.S}},{name:"C",visible:!0,numargs:1,build:function(){return K.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build:function(){return K.Limit.limit}}]),t.api()}()}();var i=t,n=Object.freeze(Object.assign(Object.create(null),t,{[Symbol.toStringTag]:"Module",default:i}));export{n as C};
